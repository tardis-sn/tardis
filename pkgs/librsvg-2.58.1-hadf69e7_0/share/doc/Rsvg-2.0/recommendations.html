<!--
SPDX-FileCopyrightText: Librsvg developers

SPDX-License-Identifier: LGPL-2.1-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Rsvg &ndash; 2.0: Recommendations for Applications</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="librsvg-r.svg"/>
  <meta property="og:image:alt" content="Rsvg-2.0"/>
  

  
  <meta property="og:title" content="Rsvg: Recommendations for Applications"/>
  <meta property="og:description" content="Reference for Rsvg-2.0: Recommendations for Applications"/>
  <meta name="twitter:title" content="Rsvg: Recommendations for Applications"/>
  <meta name="twitter:description" content="Reference for Rsvg-2.0: Recommendations for Applications"/>


  
  <meta name="twitter:card" content="summary"/>

  
  
  
  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>

  
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <a href="index.html"><img src="librsvg-r.svg" class="logo"/></a>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">Rsvg</a></h3>
        <p>API Version: 2.0</p>
        
        <p>Library Version: 2.58.1</p>
        
      </div>
      
      
      <div class="section generator">
        <p>Generated by <a href="https://gitlab.gnome.org/GNOME/gi-docgen">gi-docgen</a> 2024.1</p>
      </div>
    </nav>

    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>

    
<section id="main" class="content">
  
  <h4 id="title" style="display:flex;">
    Recommendations for Applications
    <a href="#title" class="anchor"></a>
    
  </h4>
  
  <section>
    <div class="docblock">
    <h1 id="recommendations-for-applications">Recommendations for Applications<a class="md-anchor" href="#recommendations-for-applications" title="Permanent link"></a></h1>
<p>Let&#8217;s consider two common cases for rendering <span class="caps">SVG</span>&nbsp;documents:</p>
<ul>
<li>
<p>Your application uses fixed-size assets, for example, &#8220;all icons at
  16×16&nbsp;pixels&#8221;.</p>
</li>
<li>
<p>Your application needs to accept arbitrarily-sized <span class="caps">SVG</span> documents, to
  either render them at a fixed size, or to render them at a &#8220;natural&#8221;&nbsp;size.</p>
</li>
</ul>
<p>In either case, librsvg assumes that for rendering you have already
obtained a Cairo surface, and a Cairo context to draw on the surface.
For the case of fixed-size assets, this is easy; you create a surface
of the size you know you want, and tell librsvg to render to it at
that exact size.  For the case of wanting to use a &#8220;natural&#8221; size, you
first have to ask librsvg about the document&#8217;s size so you can create
an appropriately-sized surface.  Let&#8217;s see how to do both&nbsp;cases.</p>
<h2 id="rendering-svg-assets-at-a-fixed-size">Rendering SVG assets at a fixed size<a class="md-anchor" href="#rendering-svg-assets-at-a-fixed-size" title="Permanent link"></a></h2>
<p>This is the case when you have a known <code>WIDTH</code> and <code>HEIGHT</code>, and you
want to tell librsvg to render an <span class="caps">SVG</span> at that&nbsp;size:</p>
<div class="codehilite"><pre><span></span><code><span class="n">GError</span><span class="w"> </span><span class="o">*</span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="n">GFile</span><span class="w"> </span><span class="o">*</span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">g_file_new_for_path</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;hello.svg&quot;</span><span class="p">);</span>
<span class="n">RsvgHandle</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rsvg_handle_new_from_gfile_sync</span><span class="w"> </span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="w"> </span><span class="n">RSVG_HANDLE_FLAGS_NONE</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error</span><span class="p">);</span><span class="w">    </span><span class="cm">/* 1 */</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">handle</span><span class="p">)</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">g_error</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;could not load: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="n">cairo_surface_t</span><span class="w"> </span><span class="o">*</span><span class="n">surface</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cairo_image_surface_create</span><span class="w"> </span><span class="p">(</span><span class="n">CAIRO_FORMAT_ARGB32</span><span class="p">,</span><span class="w"> </span><span class="n">WIDTH</span><span class="p">,</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">);</span><span class="w">           </span><span class="cm">/* 2 */</span>
<span class="n">cairo_t</span><span class="w"> </span><span class="o">*</span><span class="n">cr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cairo_create</span><span class="w"> </span><span class="p">(</span><span class="n">surface</span><span class="p">);</span>

<span class="cm">/* Render the handle scaled proportionally into that whole surface */</span>

<span class="n">RsvgRectangle</span><span class="w"> </span><span class="n">viewport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w">                                                                            </span><span class="cm">/* 3 */</span>
<span class="w">  </span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">  </span><span class="p">.</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span>
<span class="w">  </span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WIDTH</span><span class="p">,</span>
<span class="w">  </span><span class="p">.</span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HEIGHT</span><span class="p">,</span>
<span class="p">};</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">rsvg_handle_render_document</span><span class="w"> </span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="w"> </span><span class="n">cr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">viewport</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">error</span><span class="p">))</span><span class="w">                                     </span><span class="cm">/* 4 */</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="n">g_error</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;could not render: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="o">-&gt;</span><span class="n">message</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="cm">/* The surface is now rendered */</span>
</code></pre></div>

<ol>
<li>
<p>Load the <span class="caps">SVG</span>&nbsp;document.</p>
</li>
<li>
<p>Create an image surface of the size you&nbsp;want.</p>
</li>
<li>
<p>Declare a viewport of that size.  If you want a non-zero <code>(x, y)</code>
   offset you can set it right&nbsp;there.</p>
</li>
<li>
<p>Render the document within that viewport.&nbsp;Done!</p>
</li>
</ol>
<p>This will scale the <span class="caps">SVG</span> document proportionally to make it fit in
<code>WIDTH×HEIGHT</code> pixels.</p>
<h2 id="picking-a-natural-size-for-svg-documents">Picking a "natural" size for SVG documents<a class="md-anchor" href="#picking-a-natural-size-for-svg-documents" title="Permanent link"></a></h2>
<p>In some cases, your application may not want to use a predefined size,
but instead query the <span class="caps">SVG</span> for a &#8220;natural&#8221; size at which to render.  Some
<span class="caps">SVG</span> documents make this easy, and some&nbsp;don&#8217;t.</p>
<h3 id="svg-documents-with-intrinsic-dimensions-in-absolute-units">SVG documents with intrinsic dimensions in absolute units<a class="md-anchor" href="#svg-documents-with-intrinsic-dimensions-in-absolute-units" title="Permanent link"></a></h3>
<p>Consider an <span class="caps">SVG</span> document that starts like&nbsp;this:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;svg</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;200&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;100&quot;</span><span class="nt">&gt;</span>
</code></pre></div>

<p>This is completely unambiguous; the <span class="caps">SVG</span> says that its intrinsic size
is 200×100 pixels.  It can be scaled arbitrarily, but of course most
of the time you&#8217;ll want to scale it proportionally at that 2:1&nbsp;ratio.</p>
<p>Here is a slightly more complicated&nbsp;case:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;svg</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10cm&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;5cm&quot;</span><span class="nt">&gt;</span>
</code></pre></div>

<p>The <span class="caps">SVG</span> says that its intrinsic size is 10cm × 5cm.  This is not hard
to convert to pixels if you know the Dots-Per-Inch (<span class="caps">DPI</span>) at which you
want to render things, but it is a small&nbsp;inconvenience.</p>
<p>And here is a more complicated case&nbsp;still:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;svg</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span><span class="w"> </span><span class="na">width=</span><span class="s">&quot;10em&quot;</span><span class="w"> </span><span class="na">height=</span><span class="s">&quot;5em&quot;</span><span class="nt">&gt;</span>
<span class="w">  </span><span class="nt">&lt;style&gt;</span>
<span class="w">    </span>*<span class="w"> </span>{<span class="w"> </span>font-size:<span class="w"> </span>2cm;<span class="w"> </span>}
<span class="w">  </span><span class="nt">&lt;/style&gt;</span>
</code></pre></div>

<p>This means that the width is 10 times the font size of 2cm, and the
height is 5 times the font&nbsp;size.</p>
<p>In general an application cannot figure this out easily, since it
would need a <span class="caps">CSS</span> parser and cascading engine to even be able to know
what the font size is for the toplevel <code>&lt;svg&gt;</code>.  Fortunately, librsvg
already does&nbsp;that!</p>
<p>In all those cases, the width and height are in physical units (px,
cm, mm, etc.), or font-based units (em, ex) that can be resolved to
pixels.  You can use <a href="method.Handle.get_intrinsic_size_in_pixels.html"><code>rsvg_handle_get_intrinsic_size_in_pixels()</code></a>
to do the conversion easily if all you want to do is to create a
surface with the &#8220;natural&#8221; number of&nbsp;pixels:</p>
<div class="codehilite"><pre><span></span><code><span class="n">gboolean</span><span class="w"> </span><span class="nf">rsvg_handle_get_intrinsic_size_in_pixels</span><span class="w"> </span><span class="p">(</span><span class="n">RsvgHandle</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">,</span>
<span class="w">                                                   </span><span class="n">gdouble</span><span class="w">    </span><span class="o">*</span><span class="n">out_width</span><span class="p">,</span>
<span class="w">                                                   </span><span class="n">gdouble</span><span class="w">    </span><span class="o">*</span><span class="n">out_height</span><span class="p">);</span>
</code></pre></div>

<p>However, the documentation for <a href="method.Handle.get_intrinsic_size_in_pixels.html">that
function</a> indicates
that it may return <code>FALSE</code> in some cases.  Let&#8217;s see what those ugly
cases&nbsp;are.</p>
<h3 id="svg-documents-with-just-proportions">SVG documents with just proportions<a class="md-anchor" href="#svg-documents-with-just-proportions" title="Permanent link"></a></h3>
<p>What if we have&nbsp;this:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;svg</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span><span class="w"> </span><span class="na">viewBox=</span><span class="s">&quot;0 0 200 100&quot;</span><span class="nt">&gt;</span>
</code></pre></div>

<p>This document has no intrinsic dimensions, but it clearly states that
its <em>proportions</em> are 200:100, or 2:1.  It will look good when scaled
to a rectangle that is twice as wide as it is tall.  Our old friend
<a href="method.Handle.render_document.html"><code>rsvg_handle_render_document()</code></a> will still scale the <span class="caps">SVG</span>
proportionally to fit the viewport size you pass in.  But what if you
must pick a size yourself, instead of having a predefined&nbsp;viewport?</p>
<p>In that case you bite the bullet, call
<a href="method.Handle.get_intrinsic_dimensions.html"><code>rsvg_handle_get_intrinsic_dimensions()</code></a> and make your own choice
about what to do with the proportions that come in the <code>viewBox</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">RSVG_UNIT_PERCENT</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_PX</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_EM</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_EX</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_IN</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_CM</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_MM</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_PT</span><span class="p">,</span>
<span class="w">    </span><span class="n">RSVG_UNIT_PC</span>
<span class="p">}</span><span class="w"> </span><span class="n">RsvgUnit</span><span class="p">;</span>

<span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">double</span><span class="w">   </span><span class="n">length</span><span class="p">;</span>
<span class="w">    </span><span class="n">RsvgUnit</span><span class="w"> </span><span class="n">unit</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="n">RsvgLength</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">rsvg_handle_get_intrinsic_dimensions</span><span class="w"> </span><span class="p">(</span><span class="n">RsvgHandle</span><span class="w"> </span><span class="o">*</span><span class="n">handle</span><span class="p">,</span>
<span class="w">                                           </span><span class="n">gboolean</span><span class="w">   </span><span class="o">*</span><span class="n">out_has_width</span><span class="p">,</span>
<span class="w">                                           </span><span class="n">RsvgLength</span><span class="w"> </span><span class="o">*</span><span class="n">out_width</span><span class="p">,</span>
<span class="w">                                           </span><span class="n">gboolean</span><span class="w">   </span><span class="o">*</span><span class="n">out_has_height</span><span class="p">,</span>
<span class="w">                                           </span><span class="n">RsvgLength</span><span class="w"> </span><span class="o">*</span><span class="n">out_height</span><span class="p">,</span>
<span class="w">                                           </span><span class="n">gboolean</span><span class="w">   </span><span class="o">*</span><span class="n">out_has_viewbox</span><span class="p">,</span>
<span class="w">                                           </span><span class="n">RsvgRectangle</span><span class="w"> </span><span class="o">*</span><span class="n">out_viewbox</span><span class="p">);</span>
</code></pre></div>

<p>You&#8217;ll cleverly note that I have not answered your question.  You have
an <span class="caps">SVG</span> with only a <code>viewBox</code>, and you want to pick a reasonable size
to render&nbsp;it.</p>
<p>And here is where I want to say, <span class="caps">SVG</span> documents are <strong>scalable</strong>.  Pick
a size, any size for a viewport!  Here are some&nbsp;suggestions:</p>
<ul>
<li>
<p>The size of your window&#8217;s visible&nbsp;area.</p>
</li>
<li>
<p>The size of your device&#8217;s&nbsp;screen.</p>
</li>
<li>
<p>The size of your sheet of paper, minus the&nbsp;margins.</p>
</li>
</ul>
<p>Take that size, pass it as the viewport size to
<a href="method.Handle.render_document.html"><code>rsvg_handle_render_document()</code></a>, and be done with&nbsp;it.</p>
<h3 id="svg-documents-without-any-usable-sizing-information-at-all">SVG documents without any usable sizing information at all<a class="md-anchor" href="#svg-documents-without-any-usable-sizing-information-at-all" title="Permanent link"></a></h3>
<p>This is pretty nasty, but <em>possibly</em> not useless for doing special
effects in web&nbsp;browsers:</p>
<div class="codehilite"><pre><span></span><code><span class="nt">&lt;svg</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/2000/svg&quot;</span><span class="nt">&gt;</span>
</code></pre></div>

<p>That&#8217;s right, no <code>width</code>, no <code>height</code>, no <code>viewBox</code>.  There is no easy
way to figure out a suitable size for this.  You have two&nbsp;options:</p>
<ul>
<li>
<p>Shrug your shoulders, and <a href="method.Handle.render_document.html"><code>rsvg_handle_render_document()</code></a> with
  a comfortable viewport size like in the last&nbsp;section.</p>
</li>
<li>
<p>Do a best-effort job of actually computing the geometries of all the
  elements in the document.  You can use
  <a href="method.Handle.get_geometry_for_element.html"><code>rsvg_handle_get_geometry_for_element()</code></a> by passing <code>NULL</code> for
  the target element&#8217;s <code>id</code>; this will measure all the elements in the
  document.  This is not expensive for typical SVGs, but it is not
  &#8220;almost instantaneous&#8221; like just asking for intrinsic dimensions
  would&nbsp;be.</p>
</li>
</ul>
<p>If this is starting to sound too complicated, please remember that
<strong><span class="caps">SVG</span> documents are scalable</strong>.  That&#8217;s their whole reason for being!
Pick a size for a viewport, and ask librsvg to render the document
within that viewport with <a href="method.Handle.render_document.html"><code>rsvg_handle_render_document()</code></a>.</p>
<h2 id="recommendations-for-applications-with-svg-assets">Recommendations for applications with SVG assets<a class="md-anchor" href="#recommendations-for-applications-with-svg-assets" title="Permanent link"></a></h2>
<p>Before librsvg 2.46, applications would normally load an <span class="caps">SVG</span> asset, then
they would query librsvg for the <span class="caps">SVG</span>&#8217;s size, and then they would
compute the dimensions of their user interface based on the <span class="caps">SVG</span>&#8217;s&nbsp;size.</p>
<p>With librsvg 2.46 and later, applications may have an easier time by
letting the <span class="caps">UI</span> choose whatever size it wants, or by hardcoding a size
for <span class="caps">SVG</span> assets, and then asking librsvg to render <span class="caps">SVG</span> assets at that
particular size. Applications can use <a href="method.Handle.render_document.html"><code>rsvg_handle_render_document()</code></a>,
which takes a destination viewport, to do this in a single&nbsp;step.</p>
<p>To extract individual elements from an <span class="caps">SVG</span> document and render them in
arbitrary locations — for example, to extract a single icon from a
document full of icons —, applications can use
<a href="method.Handle.render_element.html"><code>rsvg_handle_render_element()</code></a>.</p>
<h3 id="injecting-a-user-stylesheet">Injecting a user stylesheet<a class="md-anchor" href="#injecting-a-user-stylesheet" title="Permanent link"></a></h3>
<p>It is sometimes convenient for applications to inject an extra
stylesheet while rendering an <span class="caps">SVG</span> document. You can do this with
<a href="method.Handle.set_stylesheet.html"><code>rsvg_handle_set_stylesheet()</code></a>. During the <span class="caps">CSS</span> cascade, the specified
stylesheet will be used with a <a href="https://drafts.csswg.org/css-cascade-3/#cascading-origins">&#8220;User&#8221;
origin</a>.</p>
    </div>
  </section>
</section>


    
<div id="toc" class="toc">
  <nav aria-labelledby="toc-title">
    <p id="toc-title">Content</p>
    <ul class="toc-list">
      
        
        <li class="toc-list-item"><a href="#rendering-svg-assets-at-a-fixed-size"><span class="link-text">Rendering SVG assets at a fixed size</span></a></li>
        
        <li class="toc-list-item"><a href="#picking-a-natural-size-for-svg-documents"><span class="link-text">Picking a &#34;natural&#34; size for SVG documents</span></a></li>
        
        <li class="toc-list-item"><a href="#recommendations-for-applications-with-svg-assets"><span class="link-text">Recommendations for applications with SVG assets</span></a></li>
        
      
    </ul>
  </nav>
</div>


    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>