<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 12.2.1 (20250203.1708)
 -->
<!-- Pages: 1 -->
<svg width="449pt" height="784pt"
 viewBox="0.00 0.00 448.50 784.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 780)">
<polygon fill="white" stroke="none" points="-4,4 -4,-780 444.5,-780 444.5,4 -4,4"/>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="none" stroke="black" d="M331.5,-776C331.5,-776 301.5,-776 301.5,-776 295.5,-776 289.5,-770 289.5,-764 289.5,-764 289.5,-752 289.5,-752 289.5,-746 295.5,-740 301.5,-740 301.5,-740 331.5,-740 331.5,-740 337.5,-740 343.5,-746 343.5,-752 343.5,-752 343.5,-764 343.5,-764 343.5,-770 337.5,-776 331.5,-776"/>
<text text-anchor="middle" x="316.5" y="-754.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Start</text>
</g>
<!-- allpacketsprocessed -->
<g id="node3" class="node">
<title>allpacketsprocessed</title>
<polygon fill="none" stroke="black" points="316.5,-703 250.25,-671 316.5,-639 382.75,-671 316.5,-703"/>
<text text-anchor="middle" x="316.5" y="-673.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">All packets</text>
<text text-anchor="middle" x="316.5" y="-661.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">processed?</text>
</g>
<!-- start&#45;&gt;allpacketsprocessed -->
<g id="edge1" class="edge">
<title>start&#45;&gt;allpacketsprocessed</title>
<path fill="none" stroke="black" d="M316.5,-739.8C316.5,-732.43 316.5,-723.47 316.5,-714.51"/>
<polygon fill="black" stroke="black" points="320,-714.79 316.5,-704.79 313,-714.79 320,-714.79"/>
</g>
<!-- end -->
<g id="node2" class="node">
<title>end</title>
<path fill="none" stroke="black" d="M237.5,-591C237.5,-591 207.5,-591 207.5,-591 201.5,-591 195.5,-585 195.5,-579 195.5,-579 195.5,-567 195.5,-567 195.5,-561 201.5,-555 207.5,-555 207.5,-555 237.5,-555 237.5,-555 243.5,-555 249.5,-561 249.5,-567 249.5,-567 249.5,-579 249.5,-579 249.5,-585 243.5,-591 237.5,-591"/>
<text text-anchor="middle" x="222.5" y="-569.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">End</text>
</g>
<!-- allpacketsprocessed&#45;&gt;end -->
<g id="edge3" class="edge">
<title>allpacketsprocessed&#45;&gt;end</title>
<path fill="none" stroke="black" d="M295.64,-648.69C281.4,-634.15 262.47,-614.82 247.43,-599.46"/>
<polygon fill="black" stroke="black" points="250.09,-597.18 240.6,-592.48 245.09,-602.07 250.09,-597.18"/>
<text text-anchor="middle" x="274.56" y="-611.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- nextpacket -->
<g id="node7" class="node">
<title>nextpacket</title>
<path fill="none" stroke="black" d="M353.38,-591C353.38,-591 279.62,-591 279.62,-591 273.62,-591 267.62,-585 267.62,-579 267.62,-579 267.62,-567 267.62,-567 267.62,-561 273.62,-555 279.62,-555 279.62,-555 353.38,-555 353.38,-555 359.38,-555 365.38,-561 365.38,-567 365.38,-567 365.38,-579 365.38,-579 365.38,-585 359.38,-591 353.38,-591"/>
<text text-anchor="middle" x="316.5" y="-575.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Select next packet</text>
<text text-anchor="middle" x="316.5" y="-563.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">from pool</text>
</g>
<!-- allpacketsprocessed&#45;&gt;nextpacket -->
<g id="edge2" class="edge">
<title>allpacketsprocessed&#45;&gt;nextpacket</title>
<path fill="none" stroke="black" d="M316.5,-638.57C316.5,-627.08 316.5,-614.15 316.5,-602.9"/>
<polygon fill="black" stroke="black" points="320,-603.01 316.5,-593.01 313,-603.01 320,-603.01"/>
<text text-anchor="middle" x="321.75" y="-611.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- shortestdistance -->
<g id="node4" class="node">
<title>shortestdistance</title>
<polygon fill="none" stroke="black" points="237.5,-372 153.25,-340 237.5,-308 321.75,-340 237.5,-372"/>
<text text-anchor="middle" x="237.5" y="-342.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Distance to cell</text>
<text text-anchor="middle" x="237.5" y="-330.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">edge shortest?</text>
</g>
<!-- outeredge -->
<g id="node5" class="node">
<title>outeredge</title>
<polygon fill="none" stroke="black" points="320.5,-260 228.75,-228 320.5,-196 412.25,-228 320.5,-260"/>
<text text-anchor="middle" x="320.5" y="-230.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Escaping through</text>
<text text-anchor="middle" x="320.5" y="-218.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">surface?</text>
</g>
<!-- shortestdistance&#45;&gt;outeredge -->
<g id="edge7" class="edge">
<title>shortestdistance&#45;&gt;outeredge</title>
<path fill="none" stroke="black" d="M255.92,-314.59C267.45,-299.31 282.45,-279.43 295.1,-262.66"/>
<polygon fill="black" stroke="black" points="297.7,-265.02 300.93,-254.93 292.12,-260.81 297.7,-265.02"/>
<text text-anchor="middle" x="289.36" y="-280.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- interact -->
<g id="node12" class="node">
<title>interact</title>
<path fill="none" stroke="black" d="M199.12,-246C199.12,-246 51.88,-246 51.88,-246 45.88,-246 39.88,-240 39.88,-234 39.88,-234 39.88,-222 39.88,-222 39.88,-216 45.88,-210 51.88,-210 51.88,-210 199.12,-210 199.12,-210 205.12,-210 211.12,-216 211.12,-222 211.12,-222 211.12,-234 211.12,-234 211.12,-240 205.12,-246 199.12,-246"/>
<text text-anchor="middle" x="125.5" y="-230.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Move packet to interaction location,</text>
<text text-anchor="middle" x="125.5" y="-218.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">perform interaction</text>
</g>
<!-- shortestdistance&#45;&gt;interact -->
<g id="edge8" class="edge">
<title>shortestdistance&#45;&gt;interact</title>
<path fill="none" stroke="black" d="M214.56,-316.47C196.17,-298.41 170.35,-273.05 151.25,-254.29"/>
<polygon fill="black" stroke="black" points="153.92,-252.01 144.34,-247.5 149.02,-257 153.92,-252.01"/>
<text text-anchor="middle" x="190.11" y="-280.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- inneredge -->
<g id="node6" class="node">
<title>inneredge</title>
<polygon fill="none" stroke="black" points="147.5,-148 73,-116 147.5,-84 222,-116 147.5,-148"/>
<text text-anchor="middle" x="147.5" y="-118.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Crossing into</text>
<text text-anchor="middle" x="147.5" y="-106.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">photosphere?</text>
</g>
<!-- outeredge&#45;&gt;inneredge -->
<g id="edge12" class="edge">
<title>outeredge&#45;&gt;inneredge</title>
<path fill="none" stroke="black" d="M288.77,-206.82C259.99,-188.52 217.46,-161.48 186.59,-141.86"/>
<polygon fill="black" stroke="black" points="188.6,-138.99 178.29,-136.58 184.85,-144.89 188.6,-138.99"/>
<text text-anchor="middle" x="244.44" y="-168.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- spectralcontrib -->
<g id="node13" class="node">
<title>spectralcontrib</title>
<path fill="none" stroke="black" d="M397,-134C397,-134 252,-134 252,-134 246,-134 240,-128 240,-122 240,-122 240,-110 240,-110 240,-104 246,-98 252,-98 252,-98 397,-98 397,-98 403,-98 409,-104 409,-110 409,-110 409,-122 409,-122 409,-128 403,-134 397,-134"/>
<text text-anchor="middle" x="324.5" y="-112.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Determine contribution to spectrum</text>
</g>
<!-- outeredge&#45;&gt;spectralcontrib -->
<g id="edge11" class="edge">
<title>outeredge&#45;&gt;spectralcontrib</title>
<path fill="none" stroke="black" d="M321.62,-196.07C322.2,-180.32 322.89,-161.3 323.45,-145.86"/>
<polygon fill="black" stroke="black" points="326.95,-146.01 323.81,-135.89 319.95,-145.75 326.95,-146.01"/>
<text text-anchor="middle" x="330.49" y="-168.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- crossintoshell -->
<g id="node10" class="node">
<title>crossintoshell</title>
<path fill="none" stroke="black" d="M79,-36C79,-36 12,-36 12,-36 6,-36 0,-30 0,-24 0,-24 0,-12 0,-12 0,-6 6,0 12,0 12,0 79,0 79,0 85,0 91,-6 91,-12 91,-12 91,-24 91,-24 91,-30 85,-36 79,-36"/>
<text text-anchor="middle" x="45.5" y="-20.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Move packet into</text>
<text text-anchor="middle" x="45.5" y="-8.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">next cell</text>
</g>
<!-- inneredge&#45;&gt;crossintoshell -->
<g id="edge14" class="edge">
<title>inneredge&#45;&gt;crossintoshell</title>
<path fill="none" stroke="black" d="M124.61,-93.46C109,-78.77 88.29,-59.27 71.98,-43.92"/>
<polygon fill="black" stroke="black" points="74.68,-41.65 65,-37.35 69.88,-46.75 74.68,-41.65"/>
<text text-anchor="middle" x="98.69" y="-56.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">no</text>
</g>
<!-- terminate -->
<g id="node11" class="node">
<title>terminate</title>
<path fill="none" stroke="black" d="M370,-36C370,-36 279,-36 279,-36 273,-36 267,-30 267,-24 267,-24 267,-12 267,-12 267,-6 273,0 279,0 279,0 370,0 370,0 376,0 382,-6 382,-12 382,-12 382,-24 382,-24 382,-30 376,-36 370,-36"/>
<text text-anchor="middle" x="324.5" y="-20.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Terminate propagation,</text>
<text text-anchor="middle" x="324.5" y="-8.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">discard packet</text>
</g>
<!-- inneredge&#45;&gt;terminate -->
<g id="edge13" class="edge">
<title>inneredge&#45;&gt;terminate</title>
<path fill="none" stroke="black" d="M179.55,-97.62C208.41,-81.96 251.01,-58.86 282.56,-41.75"/>
<polygon fill="black" stroke="black" points="283.93,-44.98 291.06,-37.14 280.6,-38.83 283.93,-44.98"/>
<text text-anchor="middle" x="264.93" y="-56.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">yes</text>
</g>
<!-- initpacket -->
<g id="node8" class="node">
<title>initpacket</title>
<path fill="none" stroke="black" d="M284.62,-518C284.62,-518 224.38,-518 224.38,-518 218.38,-518 212.38,-512 212.38,-506 212.38,-506 212.38,-494 212.38,-494 212.38,-488 218.38,-482 224.38,-482 224.38,-482 284.62,-482 284.62,-482 290.62,-482 296.62,-488 296.62,-494 296.62,-494 296.62,-506 296.62,-506 296.62,-512 290.62,-518 284.62,-518"/>
<text text-anchor="middle" x="254.5" y="-496.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Initialize packet</text>
</g>
<!-- nextpacket&#45;&gt;initpacket -->
<g id="edge4" class="edge">
<title>nextpacket&#45;&gt;initpacket</title>
<path fill="none" stroke="black" d="M301.49,-554.81C294.1,-546.35 285.05,-535.98 276.87,-526.61"/>
<polygon fill="black" stroke="black" points="279.58,-524.4 270.37,-519.17 274.31,-529 279.58,-524.4"/>
</g>
<!-- calculatedistances -->
<g id="node9" class="node">
<title>calculatedistances</title>
<path fill="none" stroke="black" d="M222.5,-445C222.5,-445 98.5,-445 98.5,-445 92.5,-445 86.5,-439 86.5,-433 86.5,-433 86.5,-421 86.5,-421 86.5,-415 92.5,-409 98.5,-409 98.5,-409 222.5,-409 222.5,-409 228.5,-409 234.5,-415 234.5,-421 234.5,-421 234.5,-433 234.5,-433 234.5,-439 228.5,-445 222.5,-445"/>
<text text-anchor="middle" x="160.5" y="-429.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">Calculated distances:</text>
<text text-anchor="middle" x="160.5" y="-417.5" font-family="Helvetica Neue, Helvetica, Arial, sans-serif" font-size="10.00">to next cell, to next interaction</text>
</g>
<!-- initpacket&#45;&gt;calculatedistances -->
<g id="edge5" class="edge">
<title>initpacket&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M231.75,-481.81C219.94,-472.9 205.32,-461.86 192.41,-452.1"/>
<polygon fill="black" stroke="black" points="194.67,-449.42 184.58,-446.19 190.45,-455.01 194.67,-449.42"/>
</g>
<!-- calculatedistances&#45;&gt;shortestdistance -->
<g id="edge6" class="edge">
<title>calculatedistances&#45;&gt;shortestdistance</title>
<path fill="none" stroke="black" d="M176.08,-408.8C185.51,-398.39 197.82,-384.81 208.94,-372.53"/>
<polygon fill="black" stroke="black" points="211.26,-375.18 215.38,-365.42 206.07,-370.48 211.26,-375.18"/>
</g>
<!-- crossintoshell&#45;&gt;calculatedistances -->
<g id="edge10" class="edge">
<title>crossintoshell&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M35.3,-36.39C25.28,-55.14 11.5,-86.18 11.5,-115 11.5,-341 11.5,-341 11.5,-341 11.5,-375.4 41.83,-396.06 75.12,-408.38"/>
<polygon fill="black" stroke="black" points="73.97,-411.68 84.57,-411.6 76.23,-405.06 73.97,-411.68"/>
</g>
<!-- terminate&#45;&gt;allpacketsprocessed -->
<g id="edge16" class="edge">
<title>terminate&#45;&gt;allpacketsprocessed</title>
<path fill="none" stroke="black" d="M371.68,-36.43C403.8,-51.69 440.5,-77.36 440.5,-115 440.5,-574 440.5,-574 440.5,-574 440.5,-613.23 401.21,-638.71 366.87,-653.49"/>
<polygon fill="black" stroke="black" points="365.77,-650.16 357.82,-657.17 368.4,-656.65 365.77,-650.16"/>
</g>
<!-- interact&#45;&gt;calculatedistances -->
<g id="edge9" class="edge">
<title>interact&#45;&gt;calculatedistances</title>
<path fill="none" stroke="black" d="M126.92,-246.32C129.34,-273.36 134.94,-327.18 144.5,-372 146.3,-380.45 148.77,-389.5 151.22,-397.73"/>
<polygon fill="black" stroke="black" points="147.86,-398.71 154.17,-407.22 154.55,-396.63 147.86,-398.71"/>
</g>
<!-- spectralcontrib&#45;&gt;terminate -->
<g id="edge15" class="edge">
<title>spectralcontrib&#45;&gt;terminate</title>
<path fill="none" stroke="black" d="M324.5,-97.84C324.5,-83.86 324.5,-63.84 324.5,-47.47"/>
<polygon fill="black" stroke="black" points="328,-47.85 324.5,-37.85 321,-47.85 328,-47.85"/>
</g>
</g>
</svg>
