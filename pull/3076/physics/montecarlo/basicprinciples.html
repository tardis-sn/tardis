

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monte Carlo Radiative Transfer - Basic Principles &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.13/dist/embed-amd.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Energy Packet Initialization" href="initialization.html" />
    <link rel="prev" title="Monte Carlo Iteration" href="index.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../io/hdf/index.html">Hierarchical Data Format (HDF5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/model/index.html">Reading Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analyzing Tardis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/spectrum/index.html">Analyzing TARDIS Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/liv_plot_notebook.html">Analyzing Last Interaction Velocity (LIV) Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/rpacket_plot_notebook.html">Analysing Montecarlo Packets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/analysing_convergence_plot.html">Convergence Plots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Monte Carlo Iteration</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Monte Carlo Radiative Transfer - Basic Principles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#random-sampling-basics">Random Sampling Basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inverse-transformation-method">Inverse transformation method</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="initialization.html">Energy Packet Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="propagation.html">Packet Propagation</a></li>
<li class="toctree-l2"><a class="reference internal" href="lineinteraction.html">Line Interaction Treatments</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimators.html">Volume-Based Estimators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tardisgamma/index.html">TARDIS-High Energy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/code_comparison/index.html">Code Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">References and Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Monte Carlo Iteration</a></li>
      <li class="breadcrumb-item active">Monte Carlo Radiative Transfer - Basic Principles</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/physics/montecarlo/basicprinciples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="monte-carlo-radiative-transfer-basic-principles">
<span id="montecarlo-basics"></span><h1>Monte Carlo Radiative Transfer - Basic Principles<a class="headerlink" href="#monte-carlo-radiative-transfer-basic-principles" title="Link to this heading">¶</a></h1>
<p>Radiative transfer describes how electromagnetic radiation (light) propagates through a medium. Since there are
a large number of light-matter interactions that have the possibility of affecting the light propagation, solving
the radiative transfer problem is in most astrophysical cases only possible by means of numerical calculations.
While there are many different numerical techniques available to tackle this, Monte Carlo techniques have become a
successful and elegant tool particularly for radiative transfer problems in supernovae.</p>
<p>Monte Carlo Radiative Transfer methods track a sufficiently large number of photons (light particles) as they
propagate through the supernova ejecta. The initial properties of these photons are randomly (in a probabilistic
sense) assigned in accordance with the macroscopic properties of the radiation field (see <a class="reference internal" href="initialization.html"><span class="doc">Energy Packet Initialization</span></a>)
and in a similar manner the decisions about when, where and how the photons interact with the surrounding material
are made (see <a class="reference internal" href="propagation.html#propagation"><span class="std std-ref">Propagation</span></a>). Given a large enough sample, these photons behave as a microcosm
of all of the light traveling through the ejecta – that is, based on the behavior of these photons, we can draw
conclusions about the propagation of light through the ejecta as a whole (see <a class="reference internal" href="estimators.html#estimators"><span class="std std-ref">Volume-Based Estimators</span></a>). This is eventually
used to determine the actual steady-state plasma properties (see <a class="reference internal" href="../update_and_conv/update_and_conv.html"><span class="doc">Updating Plasma and Convergence</span></a>) and the
emitted spectrum (see <a class="reference internal" href="../../analyzing_tardis/spectrum/index.html#spectrum"><span class="std std-ref">Analyzing TARDIS Spectra</span></a>).</p>
<section id="random-sampling-basics">
<span id="randomsampling"></span><h2>Random Sampling Basics<a class="headerlink" href="#random-sampling-basics" title="Link to this heading">¶</a></h2>
<p>Both the initialization of these photons and their propagation through the ejecta are modeled through
probabilistic processes. This involves assigning probabilities to the occurrence of certain events or properties.
For example, during isotropic scattering, finding a photon scattering into any given direction is equally likely.
During the Monte Carlo simulation, assignments
according to these probabilities have to be frequently performed. For this purpose, so-called Random
Number Generators are available. These produce (pseudo-) random numbers
<span class="math notranslate nohighlight">\(z\)</span> uniformly distributed on the interval <span class="math notranslate nohighlight">\([0,1]\)</span>. The challenge
now lies in using these numbers to sample any physical process involved in the
Radiative transfer calculation. From a probability theory point of view, this
just implies finding a mapping between the probability distribution governing the
physical process and the one underlying the Random Number Generator. This
process is typically referred to as random sampling.</p>
<section id="inverse-transformation-method">
<h3>Inverse transformation method<a class="headerlink" href="#inverse-transformation-method" title="Link to this heading">¶</a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a very superficial and sloppy description of Random sampling. More
detailed and rigorous accounts are found in the standard literature, for
example in <span id="id1">[<a class="reference internal" href="../../resources/zreferences.html#id5" title="M. H. Kalos and P. A. Whitlock. Monte Carlo Methods: Second Revised and Enlarged Edition. Wiley-VCH Verlag, 2008.">KalosWhitlock08</a>]</span>.</p>
</div>
<p>The simplest and most-used technique in Monte Carlo radiative transfer
applications is referred to as the inverse transformation method and involves
the cumulative distribution function. In general, a random process captured by
the random variable <span class="math notranslate nohighlight">\(X\)</span> is governed by a probability density
<span class="math notranslate nohighlight">\(\rho_X(x)\)</span> (the continuous counterpart to discrete probabilities), with
<span class="math notranslate nohighlight">\(\rho_X(x) \mathrm{d}x\)</span> describing the probability of the variable taking
values in the interval <span class="math notranslate nohighlight">\([x, x+\mathrm{d}x]\)</span>. The cumulative distribution
function in turn describes, as the name suggests, the probability of the
variable taking any value between <span class="math notranslate nohighlight">\(-\infty\)</span> and <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="math notranslate nohighlight">
\[f_X(x) = \int_{-\infty}^x \mathrm{d}x \rho_X(x)\]</div>
<p>Since the probability density is by definition always positive, the cumulative
distribution function is monotonically increasing. This constitutes the basis
for the inverse transformation function. Consider two random variables,
<span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span>. A mapping between those may be established by equating
their cumulative distribution functions. Numbers <span class="math notranslate nohighlight">\(y\)</span> distributed
according to one of the probability densities (in this case <span class="math notranslate nohighlight">\(\rho_Y(y)\)</span>)
may then be used to sample the other process by</p>
<div class="math notranslate nohighlight">
\[x = f_X^{-1}\left(f_Y(y)\right).\]</div>
<p>For the Random Number Generators described above, the cumulative distribution
function is trivial, namely <span class="math notranslate nohighlight">\(f_Z(z) = z\)</span>. However, the inverse
distribution sampling method relies on finding the analytic inverse function of
the cumulative distribution function governing the physical processes to be
sampled. If this is not possible, other sampling methods, such as von-Neumann
rejection sampling techniques, have to be used.</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<p>A few examples are provided to illustrate the random sampling process using the
inverse transformation technique.</p>
<section id="isotropic-scattering">
<h4>Isotropic Scattering<a class="headerlink" href="#isotropic-scattering" title="Link to this heading">¶</a></h4>
<p>Consider the case of an isotropic scattering.
Here, all scattering angles are equally likely. Thus, the corresponding
(normalized) probability density and the cumulative distribution function are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho(\mu) &amp;= \frac{1}{2}\\
f(\mu) &amp;= \frac{1}{2} (\mu + 1).\end{split}\]</div>
<p>This leads to the sampling rule</p>
<div class="math notranslate nohighlight">
\[\mu = 2 z - 1.\]</div>
</section>
<section id="next-interaction-location">
<h4>Next Interaction Location<a class="headerlink" href="#next-interaction-location" title="Link to this heading">¶</a></h4>
<p>The probability of a photon interacting after covering an optical depth
<span class="math notranslate nohighlight">\(\tau\)</span> is given by (see <a class="reference internal" href="propagation.html#propagation"><span class="std std-ref">Packet Propagation</span></a>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}\rho(\tau) &amp;= \exp(-\tau)\\
f(\tau) &amp;= 1 - \exp(-\tau).\end{split}\]</div>
<p>With the inverse transformation method, the optical depth to the next interaction location may then be sampled by</p>
<div class="math notranslate nohighlight">
\[\tau = - \mathrm{ln}(1 - z)\]</div>
<p>which is equivalent to</p>
<div class="math notranslate nohighlight">
\[\tau = - \mathrm{ln}z.\]</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Monte Carlo Iteration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="initialization.html" class="btn btn-neutral float-right" title="Energy Packet Initialization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 19 May 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>