

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Radioactive Decay Energy &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=34d1cfc7"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.13/dist/embed-amd.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="tardis" href="../../api/modules.html" />
    <link rel="prev" title="Sources of Opacity" href="opacities.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/high_energy/run_high_energy_workflow.html">TARDIS High Energy Workflow Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/visualization/tutorial_montecarlo_packet_visualization.html">Montecarlo Packet Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/index.html">Analyszing TARDIS Simulation Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/tutorial_read_configuration.html">Reading a Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/code_comparison/index.html">How to do Code Comparison using TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">TARDIS-High Energy</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="packetinitialization.html">Packet Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="opacities.html">Sources of Opacity</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Radioactive Decay Energy</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/visualization_reference.html">Visualization Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/hdf/index.html">Hierarchical Data Format (HDF5) Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">Bibliography and Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">TARDIS-High Energy</a></li>
      <li class="breadcrumb-item active">Radioactive Decay Energy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/physics_walkthrough/tardisgamma/decayenergy.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
    /* strip stderr */
    div.nboutput.container div.output_area.stderr {
        background: #fdd;
        display: none;
    }

    .launch-btn {
        background-color: #2980B9;
        border: none;
        border-radius: 4px;
        color: #fcfcfc;
        font-family: inherit;
        text-decoration: none;
        padding: 3px 8px;
        letter-spacing: 0.03em;
        display: inline-block;
        line-height: 1.5em;
    }

    .launch-btn:hover {
        background-color: #1b6391;
        color: #fcfcfc;
    }

    .launch-btn:visited {
        color: #fcfcfc;
    }

    .note-p {
        margin-bottom: 0.4em;
        line-height: 2em;
    }
</style>

<div class="admonition note">
<p class="note-p">You can interact with this notebook online: <a href="https://mybinder.org/v2/gh/tardis-sn/tardis/HEAD?filepath=docs/physics_walkthrough/tardisgamma/decayenergy.ipynb" class="launch-btn" target="_blank" rel="noopener noreferrer">Launch notebook</a></p>
</div><section id="Radioactive-Decay-Energy">
<h1>Radioactive Decay Energy<a class="headerlink" href="#Radioactive-Decay-Energy" title="Link to this heading">¶</a></h1>
<p>Within the ejecta of a supernova, the <span class="math notranslate nohighlight">\(\gamma\)</span>-rays largely come from the decay of <span class="math notranslate nohighlight">\(^{56}Ni\)</span> into <span class="math notranslate nohighlight">\(^{56}Co\)</span>, which releases a significant amount of energy.</p>
<p>When <span class="math notranslate nohighlight">\(^{56}Ni\)</span> decays into <span class="math notranslate nohighlight">\(^{56}Co\)</span> it can release a <span class="math notranslate nohighlight">\(\gamma\)</span>-ray at several different transition levels. Each transition level has an energy and an associated probability out of 100 decays. For example, the transition from Energy level 9 to Energy level 7 has an energy of 0.270 Mev and a probability of 36.5 out of 100 decays. To find the total energy per decay you multipliy each energy with its associated probability and add them all up.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.energy_input.gamma_ray_channel</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">create_isotope_dicts</span><span class="p">,</span>
    <span class="n">create_inventories_dict</span><span class="p">,</span>
    <span class="n">calculate_total_decays</span><span class="p">,</span>
    <span class="n">create_isotope_decay_df</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.energy_input.gamma_ray_transport</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_taus</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.energy_input.energy_source</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_nuclear_lines_database</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.io.atom_data</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">download_atom_data</span><span class="p">,</span> <span class="n">AtomData</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.energy_input.tests.test_gamma_ray_channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">test_total_energy_production</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ceceliapowers/software/tardis/tardis/__init__.py:23: UserWarning: Astropy is already imported externally. Astropy should be imported after TARDIS.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "0fdee0253d604567880aec1ca9bdd8d4", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9ebafa0ba7a24340bab86aaf88b565f9", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># energies of each transition</span>
<span class="n">t_energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.270</span><span class="p">,</span> <span class="mf">0.750</span><span class="p">,</span> <span class="mf">0.480</span><span class="p">,</span> <span class="mf">1.56</span><span class="p">,</span> <span class="mf">0.812</span><span class="p">,</span> <span class="mf">0.158</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MeV</span>
<span class="c1"># probabilities of each transition</span>
<span class="n">t_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">.365</span><span class="p">,</span> <span class="mf">.495</span><span class="p">,</span> <span class="mf">.366</span><span class="p">,</span> <span class="mf">.140</span><span class="p">,</span> <span class="mf">.860</span><span class="p">,</span> <span class="mf">1.00</span><span class="p">])</span>

<span class="n">energy_per_decay</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">t_energies</span> <span class="o">*</span> <span class="n">t_prob</span><span class="p">)</span>
<span class="n">energy_per_decay</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$1.7202 \; \mathrm{MeV}$</div></div>
</div>
<p>From the above cell, we get the energy per transition of 1.72 MeV. Note that this comes from a simplified scheme of energies and a more accurate total energy per <span class="math notranslate nohighlight">\(^{56}Ni\)</span> decay is 1.75 MeV. <span id="id1">[<a class="reference internal" href="../../resources/zreferences.html#id27" title="D. K. Nadyozhin. The Properties of NI CO Fe Decay. \apjs , 92:527, June 1994. doi:10.1086/192008.">Nadyozhin94</a>]</span></p>
<p>The <span class="math notranslate nohighlight">\(^{56}Co\)</span> produced from the decay of <span class="math notranslate nohighlight">\(^{56}Ni\)</span> is also radioactive and will decay into <span class="math notranslate nohighlight">\(^{56}Fe\)</span> and release more <span class="math notranslate nohighlight">\(\gamma\)</span>-rays, however this decay is more complicated than the decay of <span class="math notranslate nohighlight">\(^{56}Ni\)</span>. Whereas <span class="math notranslate nohighlight">\(^{56}Ni\)</span> only decays through electron capture, <span class="math notranslate nohighlight">\(^{56}Co\)</span> can decay either by electron capture, which occurs for 81 out of 100 cases, or through positron decay, which occurs for 19 out of 100 cases.</p>
<p>Positron decay produces positrons with a given kinetic energy, that will eventually annihilate with electrons to produce two 0.511 MeV <span class="math notranslate nohighlight">\(\gamma\)</span>-rays. The scheme of decays for <span class="math notranslate nohighlight">\(^{56}Co\)</span> is slightly more complicated than the <span class="math notranslate nohighlight">\(^{56}Ni\)</span> scheme, but to find the total energy per decay, you follow the same process. The total energy per decay from <span class="math notranslate nohighlight">\(\gamma\)</span>-rays is 3.61 MeV and the total kinetic energy of positrons is 0.12 MeV</p>
<p>The total rate of energy production for a mass of <span class="math notranslate nohighlight">\(^{56}Ni\)</span> at a given time is given by the following equation:</p>
<div class="math notranslate nohighlight">
\[\epsilon = \frac{M_\odot}{56m_{u}}\frac{1}{\tau_{\text{Co}}-\tau_{\text{Ni}}}[[Q_{\text{Ni}}(\frac{\tau_{\text{Co}}}{\tau_{\text{Ni}}}-1)-Q_{\text{Co}}]\exp(-t/\tau_{\text{Ni}})+Q_{\text{Co}}\exp(-t/\tau_{\text{Co}})]\frac{M_{Ni0}}{M_\odot}\]</div>
<p><span class="math notranslate nohighlight">\(M_\odot\)</span> is a solar mass. <span class="math notranslate nohighlight">\(56_{u}\)</span> is 56 atomic mass units.</p>
<p><span class="math notranslate nohighlight">\(\tau_{Ni}\)</span> is the lifetime of <span class="math notranslate nohighlight">\(^{56}Ni\)</span> which is 8.80 days and <span class="math notranslate nohighlight">\(\tau_{Co}\)</span> is the lifetime of <span class="math notranslate nohighlight">\(^{56}Co\)</span> which is 111.3 days.</p>
<p><span class="math notranslate nohighlight">\(Q_{\text{Ni}}\)</span> is the energy per decay of <span class="math notranslate nohighlight">\(^{56}Ni\)</span> which is 1.75 MeV and <span class="math notranslate nohighlight">\(Q_{\text{Co}}\)</span> is the sum of the energy per decay of <span class="math notranslate nohighlight">\(^{56}Co\)</span> from <span class="math notranslate nohighlight">\(\gamma\)</span>-rays and the kinetic energy from positrons which is 3.73 MeV</p>
<p>If we plug these values into the equation we get the equation:</p>
<div class="math notranslate nohighlight">
\[\epsilon = (6.45e43\exp(-t/8.8)+1.45e43\exp(-t/111.3))\frac{M_{Ni0}}{M_\odot} erg/s\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#time in days</span>
<span class="n">time</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>
<span class="c1">#mass of Ni56 in solar masses</span>
<span class="n">m_Ni56</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">const</span><span class="o">.</span><span class="n">M_sun</span>

<span class="n">energy_production_rate</span> <span class="o">=</span> <span class="p">(</span><span class="mf">6.45e43</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="p">(</span><span class="mf">8.8</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1.45e43</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="p">(</span><span class="mf">111.3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_Ni56</span><span class="o">/</span> <span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">erg</span> <span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The total energy production rate for 1 solar mass of 56Ni after 10 days is: </span><span class="si">{</span><span class="n">energy_production_rate</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The total energy production rate for 1 solar mass of 56Ni after 10 days is: 3.40e+43 erg / s
</pre></div></div>
</div>
<p>The total total energy production integrated over time is given by:</p>
<div class="math notranslate nohighlight">
\[\mathcal{E} = \mathcal{E}_{Ni} + \mathcal{E}_{Co} = 1.885e50 \frac{M_{Ni0}}{M_\odot} ergs\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\mathcal{E}_{Ni} = 6.22e49 \frac{M_{Ni0}}{M_\odot} ergs\]</div>
<div class="math notranslate nohighlight">
\[\mathcal{E}_{Co} = 1.26e50 \frac{M_{Ni0}}{M_\odot} erg\]</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_energy_production</span> <span class="o">=</span> <span class="mf">1.885e50</span> <span class="o">*</span> <span class="p">(</span><span class="n">m_Ni56</span><span class="o">/</span><span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">erg</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The total energy production for 1 solar mass of 56Ni is: </span><span class="si">{</span><span class="n">total_energy_production</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The total energy production for 1 solar mass of 56Ni is: 1.885e+50 erg
</pre></div></div>
</div>
<p>Next we show how we can find the same result from functions in TARDIS-HE</p>
<p>First we create a DataFrame with isotope abundances. This DataFrame typically comes from a model, but for our purposes we create an ejecta with 5 shells, made entirely of <span class="math notranslate nohighlight">\(^{56}Ni\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mass_fractions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                  <span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                  <span class="mi">2</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                  <span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                  <span class="mi">4</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>

<span class="n">raw_isotope_abundance</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">mass_fractions</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">([(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">56</span><span class="p">)],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;atomic_number&quot;</span><span class="p">,</span> <span class="s2">&quot;mass_number&quot;</span><span class="p">]))</span>
<span class="n">raw_isotope_abundance</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
    <tr>
      <th>atomic_number</th>
      <th>mass_number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28</th>
      <th>56</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Then we create an array of shell masses. We want to find the total energy production of 1 solar mass of <span class="math notranslate nohighlight">\(^{56}Ni\)</span>, so we give each of the five shells a mass of <span class="math notranslate nohighlight">\(\frac{1}{5}M_\odot\)</span></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shell_masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mf">0.2</span><span class="o">*</span><span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="p">)</span>
<span class="n">shell_masses</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="math notranslate nohighlight">
$[3.9768197 \times 10^{32},~3.9768197 \times 10^{32},~3.9768197 \times 10^{32},~3.9768197 \times 10^{32},~3.9768197 \times 10^{32}] \; \mathrm{g}$</div></div>
</div>
<p>Now we can use TARDIS-HE functions to get a DataFrame with information on the decays of this model. The first step is to create a dictionary which has the mass of each isotope in each shell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isotope_dict</span> <span class="o">=</span> <span class="n">create_isotope_dicts</span><span class="p">(</span><span class="n">raw_isotope_abundance</span><span class="p">,</span> <span class="n">shell_masses</span><span class="p">)</span>
<span class="n">isotope_dict</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{0: {&#39;Ni56&#39;: 3.976819741396102e+32},
 1: {&#39;Ni56&#39;: 3.976819741396102e+32},
 2: {&#39;Ni56&#39;: 3.976819741396102e+32},
 3: {&#39;Ni56&#39;: 3.976819741396102e+32},
 4: {&#39;Ni56&#39;: 3.976819741396102e+32}}
</pre></div></div>
</div>
<p>Next, we create a dictionary that holds the inventory of each isotope given in the <code class="docutils literal notranslate"><span class="pre">`radioactivedecay</span></code> &lt;<a class="reference external" href="https://radioactivedecay.github.io/">https://radioactivedecay.github.io/</a>&gt;`__ package.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inventories</span> <span class="o">=</span> <span class="n">create_inventories_dict</span><span class="p">(</span><span class="n">isotope_dict</span><span class="p">)</span>
<span class="n">inventories</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{0: Inventory activities (Bq): {&#39;Ni-56&#39;: 5.653446204017355e+48}, decay dataset: icrp107_ame2020_nubase2020,
 1: Inventory activities (Bq): {&#39;Ni-56&#39;: 5.653446204017355e+48}, decay dataset: icrp107_ame2020_nubase2020,
 2: Inventory activities (Bq): {&#39;Ni-56&#39;: 5.653446204017355e+48}, decay dataset: icrp107_ame2020_nubase2020,
 3: Inventory activities (Bq): {&#39;Ni-56&#39;: 5.653446204017355e+48}, decay dataset: icrp107_ame2020_nubase2020,
 4: Inventory activities (Bq): {&#39;Ni-56&#39;: 5.653446204017355e+48}, decay dataset: icrp107_ame2020_nubase2020}
</pre></div></div>
</div>
<p>Now we calculate the number of decays for each isotope in each shell and create a DataFrame to hold this information.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumulative_decay_df</span> <span class="o">=</span> <span class="n">calculate_total_decays</span><span class="p">(</span><span class="n">inventories</span><span class="p">,</span> <span class="n">time_delta</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cumulative_decay_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
                      number_of_decays
shell_number isotope
0            Ni56         4.281026e+54
             Co56         4.281026e+54
1            Ni56         4.281026e+54
             Co56         4.281026e+54
2            Ni56         4.281026e+54
             Co56         4.281026e+54
3            Ni56         4.281026e+54
             Co56         4.281026e+54
4            Ni56         4.281026e+54
             Co56         4.281026e+54
</pre></div></div>
</div>
<p>Next we use the <a class="reference external" href="https://github.com/tardis-sn/tardis-regression-data/raw/main/atom_data/kurucz_cd23_chianti_H_He.h5">kurucz_cd23_chianti_H_He.h5</a> dataset to get the decay radiation data for each isotope.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download_atom_data</span><span class="p">(</span><span class="s1">&#39;kurucz_cd23_chianti_H_He&#39;</span><span class="p">)</span>
<span class="n">atom_data_file</span> <span class="o">=</span> <span class="s1">&#39;kurucz_cd23_chianti_H_He.h5&#39;</span>
<span class="n">atom_data</span> <span class="o">=</span> <span class="n">AtomData</span><span class="o">.</span><span class="n">from_hdf</span><span class="p">(</span><span class="n">atom_data_file</span><span class="p">)</span>
<span class="n">gamma_ray_lines</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">decay_radiation_data</span>
<span class="n">gamma_ray_lines</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING:tardis.io.atom_data.atom_web_download:Atomic Data kurucz_cd23_chianti_H_He already exists in /home/ceceliapowers/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5. Will not download - override with force_download=True.
INFO:tardis.io.atom_data.util:
        Atom Data kurucz_cd23_chianti_H_He.h5 not found in local path.
        Exists in TARDIS Data repo /home/ceceliapowers/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace
INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data, linelist_atoms, linelist_molecules
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>Element</th>
      <th>Z</th>
      <th>N</th>
      <th>Parent E(level)</th>
      <th>Uncertainty</th>
      <th>JPi</th>
      <th>Metastable</th>
      <th>Decay Mode</th>
      <th>Decay Mode Value</th>
      <th>...</th>
      <th>Radiation</th>
      <th>Rad subtype</th>
      <th>Rad Energy</th>
      <th>Uncertainty.1</th>
      <th>EP Energy</th>
      <th>Uncertainty.2</th>
      <th>Rad Intensity</th>
      <th>Uncertainty.3</th>
      <th>Dose</th>
      <th>Uncertainty.4</th>
    </tr>
    <tr>
      <th>Isotope</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Nn1</th>
      <td>1</td>
      <td>Nn</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1/2+</td>
      <td>False</td>
      <td>B-</td>
      <td>100.0</td>
      <td>...</td>
      <td>bm</td>
      <td>NaN</td>
      <td>301.3700</td>
      <td>NaN</td>
      <td>782.347</td>
      <td>10.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>0.301000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Nn1</th>
      <td>1</td>
      <td>Nn</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1/2+</td>
      <td>False</td>
      <td>B-</td>
      <td>100.0</td>
      <td>...</td>
      <td>bm av</td>
      <td>NaN</td>
      <td>301.3700</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>0.301000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>H3</th>
      <td>3</td>
      <td>H</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1/2+</td>
      <td>False</td>
      <td>B-</td>
      <td>100.0</td>
      <td>...</td>
      <td>bm</td>
      <td>NaN</td>
      <td>5.6817</td>
      <td>12.0</td>
      <td>18.591</td>
      <td>3.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>0.005682</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>H3</th>
      <td>3</td>
      <td>H</td>
      <td>1</td>
      <td>2</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>1/2+</td>
      <td>False</td>
      <td>B-</td>
      <td>100.0</td>
      <td>...</td>
      <td>bm av</td>
      <td>NaN</td>
      <td>5.6820</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>0.005680</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>He6</th>
      <td>6</td>
      <td>He</td>
      <td>2</td>
      <td>4</td>
      <td>0</td>
      <td>NaN</td>
      <td>0+</td>
      <td>False</td>
      <td>B-</td>
      <td>100.0</td>
      <td>...</td>
      <td>bm</td>
      <td>NaN</td>
      <td>1567.6200</td>
      <td>54.0</td>
      <td>3507.800</td>
      <td>11.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>1.567600</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Lv292</th>
      <td>292</td>
      <td>Lv</td>
      <td>116</td>
      <td>176</td>
      <td>0</td>
      <td>NaN</td>
      <td>0+</td>
      <td>False</td>
      <td>A</td>
      <td>100.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Lv293</th>
      <td>293</td>
      <td>Lv</td>
      <td>116</td>
      <td>177</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>A</td>
      <td>100.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ts293</th>
      <td>293</td>
      <td>Ts</td>
      <td>117</td>
      <td>176</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>A</td>
      <td>100.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Og294</th>
      <td>294</td>
      <td>Og</td>
      <td>118</td>
      <td>176</td>
      <td>0</td>
      <td>NaN</td>
      <td>0+</td>
      <td>False</td>
      <td>A</td>
      <td>100.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Ts294</th>
      <td>294</td>
      <td>Ts</td>
      <td>117</td>
      <td>177</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>False</td>
      <td>A</td>
      <td>100.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>242295 rows × 41 columns</p>
</div></div>
</div>
<p>Finally, we can create a DataFrame with that holds all the information about the decays of each isotope in each shell.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isotope_decay_df</span> <span class="o">=</span> <span class="n">create_isotope_decay_df</span><span class="p">(</span><span class="n">cumulative_decay_df</span><span class="p">,</span> <span class="n">gamma_ray_lines</span><span class="p">)</span>
<span class="n">isotope_decay_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>number_of_decays</th>
      <th>decay_mode</th>
      <th>radiation</th>
      <th>radiation_energy_keV</th>
      <th>radiation_intensity</th>
      <th>energy_per_channel_keV</th>
      <th>decay_energy_keV</th>
      <th>decay_energy_erg</th>
    </tr>
    <tr>
      <th>shell_number</th>
      <th>isotope</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">0</th>
      <th>Ni56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>bp</td>
      <td>65.000</td>
      <td>0.00060</td>
      <td>0.000390</td>
      <td>1.669600e+51</td>
      <td>2.674994e+42</td>
    </tr>
    <tr>
      <th>Ni56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>bp</td>
      <td>408.000</td>
      <td>0.00003</td>
      <td>0.000122</td>
      <td>5.239975e+50</td>
      <td>8.395366e+41</td>
    </tr>
    <tr>
      <th>Ni56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>bp</td>
      <td>478.000</td>
      <td>0.00003</td>
      <td>0.000143</td>
      <td>6.138991e+50</td>
      <td>9.835748e+41</td>
    </tr>
    <tr>
      <th>Ni56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>bp av</td>
      <td>100.000</td>
      <td>0.00070</td>
      <td>0.000700</td>
      <td>2.996718e+51</td>
      <td>4.801271e+42</td>
    </tr>
    <tr>
      <th>Ni56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>e</td>
      <td>6.070</td>
      <td>54.50000</td>
      <td>3.308150</td>
      <td>1.416227e+55</td>
      <td>2.269047e+46</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">4</th>
      <th>Co56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>g</td>
      <td>3369.860</td>
      <td>0.01010</td>
      <td>0.340356</td>
      <td>1.457072e+54</td>
      <td>2.334487e+45</td>
    </tr>
    <tr>
      <th>Co56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>g</td>
      <td>3451.232</td>
      <td>0.94900</td>
      <td>32.752192</td>
      <td>1.402130e+56</td>
      <td>2.246459e+47</td>
    </tr>
    <tr>
      <th>Co56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>g</td>
      <td>3548.050</td>
      <td>0.19550</td>
      <td>6.936438</td>
      <td>2.969507e+55</td>
      <td>4.757674e+46</td>
    </tr>
    <tr>
      <th>Co56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>g</td>
      <td>3600.800</td>
      <td>0.01670</td>
      <td>0.601334</td>
      <td>2.574325e+54</td>
      <td>4.124523e+45</td>
    </tr>
    <tr>
      <th>Co56</th>
      <td>4.281026e+54</td>
      <td>EC</td>
      <td>g</td>
      <td>3611.530</td>
      <td>0.00860</td>
      <td>0.310592</td>
      <td>1.329651e+54</td>
      <td>2.130335e+45</td>
    </tr>
  </tbody>
</table>
<p>485 rows × 8 columns</p>
</div></div>
</div>
<p>Now we can use the data from the isotope decay DataFrame to find the energy production rate and total decay energy for the model and compare our results to the simplified analytical solution above.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">percent_error</span><span class="p">(</span><span class="n">observed</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">expected</span> <span class="o">-</span> <span class="n">observed</span><span class="p">)</span><span class="o">/</span><span class="n">expected</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
<p>First we need to find the lifetimes of each isotope using the <code class="docutils literal notranslate"><span class="pre">get_taus</span></code> function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_dict</span> <span class="o">=</span> <span class="n">get_taus</span><span class="p">(</span><span class="n">raw_isotope_abundance</span><span class="p">)</span>

<span class="n">tau_co56</span> <span class="o">=</span> <span class="n">tau_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Co-56&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">tau_ni56</span> <span class="o">=</span> <span class="n">tau_dict</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;Ni-56&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">tau_ni56_days</span> <span class="o">=</span> <span class="n">tau_ni56</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
<span class="n">tau_co56_days</span> <span class="o">=</span> <span class="n">tau_co56</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The lifetime of 56Ni is: </span><span class="si">{</span><span class="n">tau_ni56_days</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The lifetime of 56Co is: </span><span class="si">{</span><span class="n">tau_co56_days</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for 56Ni lifetime is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">tau_ni56_days</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mf">8.8</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for 56Co lifetime is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">tau_co56_days</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mf">111.3</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The lifetime of 56Ni is: 8.764372373400452 d
The lifetime of 56Co is: 111.41933800785463 d
The percent error for 56Ni lifetime is: 0.40485939317669306 %
The percent error for 56Co lifetime is: 0.1072219297885327 %
</pre></div></div>
</div>
<p>Next we find the energy per decay or Q value for both <span class="math notranslate nohighlight">\(^{56}Ni\)</span> and <span class="math notranslate nohighlight">\(^{56}Co\)</span> using the data in our isotope decay DataFrame, following a similar method as above. Here the “probabilities” are found in the <code class="docutils literal notranslate"><span class="pre">radiation_intensity</span></code> column and are in the form of number of decays per 100 decays so we have to divide by 100. The energy for each transition is found in the <code class="docutils literal notranslate"><span class="pre">radiation_energy_keV</span></code> column.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For Ni56</span>
<span class="n">ni56</span> <span class="o">=</span> <span class="n">isotope_decay_df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;Ni56&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;isotope&#39;</span><span class="p">)</span>
<span class="n">ni56_energy_per_decay_MeV</span> <span class="o">=</span> <span class="p">(</span><span class="n">ni56</span><span class="p">[</span><span class="s1">&#39;radiation_intensity&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">ni56</span><span class="p">[</span><span class="s1">&#39;radiation_energy_keV&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">keV</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;MeV&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MeV</span>

<span class="c1"># For Co56</span>
<span class="n">co56</span> <span class="o">=</span> <span class="n">isotope_decay_df</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="s1">&#39;Co56&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;isotope&#39;</span><span class="p">)</span>
<span class="n">co56_energy_per_decay_MeV</span> <span class="o">=</span> <span class="p">(</span><span class="n">co56</span><span class="p">[</span><span class="s1">&#39;radiation_intensity&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">co56</span><span class="p">[</span><span class="s1">&#39;radiation_energy_keV&#39;</span><span class="p">]</span><span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">keV</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;MeV&quot;</span><span class="p">)))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="mi">5</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">MeV</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The energy per decay for Ni56 is: </span><span class="si">{</span><span class="n">ni56_energy_per_decay_MeV</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The energy per decay for Co56 is: </span><span class="si">{</span><span class="n">co56_energy_per_decay_MeV</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for Ni56 energy per decay is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">ni56_energy_per_decay_MeV</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mf">1.75</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for Co56 energy per decay is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">co56_energy_per_decay_MeV</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mf">3.73</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The energy per decay for Ni56 is: 1.7249433621 MeV
The energy per decay for Co56 is: 3.8521702007573437 MeV
The percent error for Ni56 energy per decay is: 1.4318078799999943 %
The percent error for Co56 energy per decay is: 3.2753405028778486 %
</pre></div></div>
</div>
<p>Next we can plug the <span class="math notranslate nohighlight">\(\tau\)</span> values and Q values into the energy production rate equation to get the coefficients in the second simplified energy production rate equation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outside_factor</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span> <span class="p">(</span><span class="n">tau_co56</span> <span class="o">-</span> <span class="n">tau_ni56</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">56</span> <span class="o">*</span> <span class="mf">1.67e-24</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">g</span><span class="p">))</span>
<span class="n">ni56_coeff</span> <span class="o">=</span> <span class="n">outside_factor</span> <span class="o">*</span> <span class="p">(</span><span class="n">ni56_energy_per_decay_MeV</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;erg&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">tau_co56</span><span class="o">/</span><span class="n">tau_ni56</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">co56_energy_per_decay_MeV</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;erg&quot;</span><span class="p">))</span>
<span class="n">co56_coeff</span> <span class="o">=</span> <span class="n">outside_factor</span> <span class="o">*</span> <span class="n">co56_energy_per_decay_MeV</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;erg&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The coefficient for Ni56 is: </span><span class="si">{</span><span class="n">ni56_coeff</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The coefficient for Co56 is: </span><span class="si">{</span><span class="n">co56_coeff</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for Ni56 coefficient is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">ni56_coeff</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mf">6.45e43</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for Co56 coefficient is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">co56_coeff</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="mf">1.45e43</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The coefficient for Ni56 is: 6.280298471107531e+43 erg / s
The coefficient for Co56 is: 1.4795292955420012e+43 erg / s
The percent error for Ni56 coefficient is: 2.631031455697185 %
The percent error for Co56 coefficient is: 2.0365031408276604 %
</pre></div></div>
</div>
<p>Then we can use these coefficients to find the energy production rate after 10 days.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">energy_production_rate_from_HE</span> <span class="o">=</span> <span class="n">ni56_coeff</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">tau_ni56_days</span><span class="p">)</span> <span class="o">+</span> <span class="n">co56_coeff</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">time</span><span class="o">/</span><span class="n">tau_co56_days</span><span class="p">)</span> <span class="o">*</span>  <span class="p">(</span><span class="n">m_Ni56</span><span class="o">/</span> <span class="n">const</span><span class="o">.</span><span class="n">M_sun</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The energy production rate from TARDIS-HE is: </span><span class="si">{</span><span class="n">energy_production_rate_from_HE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for energy production rate from TARDIS-HE is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">energy_production_rate_from_HE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">energy_production_rate</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The energy production rate from TARDIS-HE is: 3.3591101069090006e+43 erg / s
The percent error for energy production rate from TARDIS-HE is: 1.0789985177098882 %
</pre></div></div>
</div>
<p>We can also sum the decay energy column of the DataFrame to find the total energy produced.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_energy_production_HE</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">isotope_decay_df</span><span class="p">[</span><span class="s2">&quot;decay_energy_erg&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">erg</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The total energy production from TARDIS-HE is: </span><span class="si">{</span><span class="n">total_energy_production_HE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The percent error for total energy production from TARDIS-HE is: </span><span class="si">{</span><span class="n">percent_error</span><span class="p">(</span><span class="n">total_energy_production_HE</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">total_energy_production</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The total energy production from TARDIS-HE is: 1.9126597273910088e+50 erg
The percent error for total energy production from TARDIS-HE is: 1.4673595432896005 %
</pre></div></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="opacities.html" class="btn btn-neutral float-left" title="Sources of Opacity" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../api/modules.html" class="btn btn-neutral float-right" title="tardis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 10 Dec 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>