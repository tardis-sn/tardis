

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=53bc6e61"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.13/dist/embed-amd.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Plasma" href="plasma/index.html" />
    <link rel="prev" title="Setup Example" href="setup_example.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/high_energy/run_high_energy_workflow.html">TARDIS High Energy Workflow Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/visualization/tutorial_montecarlo_packet_visualization.html">Montecarlo Packet Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/index.html">Analyszing TARDIS Simulation Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/tutorial_read_configuration.html">Reading a Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/code_comparison/index.html">How to do Code Comparison using TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Setting Up the Simulation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup_example.html">Setup Example</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Shell-Structure">Shell Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Density">Density</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Branch85-W7-Density">Branch85 W7 Density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Uniform-Density">Uniform Density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Power-Law-Density">Power Law Density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exponential-Density">Exponential Density</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Abundance">Abundance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Temperatures">Temperatures</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Dilution-Factor">Dilution Factor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plasma/index.html">Plasma</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tardisgamma/index.html">TARDIS-High Energy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/visualization_reference.html">Visualization Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/hdf/index.html">Hierarchical Data Format (HDF5) Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">Bibliography and Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Setting Up the Simulation</a></li>
      <li class="breadcrumb-item active">Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/physics_walkthrough/setup/model.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
    /* strip stderr */
    div.nboutput.container div.output_area.stderr {
        background: #fdd;
        display: none;
    }

    .launch-btn {
        background-color: #2980B9;
        border: none;
        border-radius: 4px;
        color: #fcfcfc;
        font-family: inherit;
        text-decoration: none;
        padding: 3px 8px;
        letter-spacing: 0.03em;
        display: inline-block;
        line-height: 1.5em;
    }

    .launch-btn:hover {
        background-color: #1b6391;
        color: #fcfcfc;
    }

    .launch-btn:visited {
        color: #fcfcfc;
    }

    .note-p {
        margin-bottom: 0.4em;
        line-height: 2em;
    }
</style>

<div class="admonition note">
<p class="note-p">You can interact with this notebook online: <a href="https://mybinder.org/v2/gh/tardis-sn/tardis/HEAD?filepath=docs/physics_walkthrough/setup/model.ipynb" class="launch-btn" target="_blank" rel="noopener noreferrer">Launch notebook</a></p>
</div><section id="Model">
<h1>Model<a class="headerlink" href="#Model" title="Link to this heading">¶</a></h1>
<p>As shown previously, when <code class="docutils literal notranslate"><span class="pre">Simulation.from_config()</span></code> is called, a <code class="docutils literal notranslate"><span class="pre">SimulationState</span></code> object is created. This is done via the class method <code class="docutils literal notranslate"><span class="pre">SimulationState.from_config()</span></code>. This model object contains important information about the shell structure, density, abundance, radiative temperature, and dilution factor throughout the supernova.</p>
<p>Throughout this notebook, we show various configuration inputs into the TARDIS model and the resulting model. In interactive mode, these parameters can be varied to explore how the model changes. Editing configuration parameters in the notebook is explained <a class="reference internal" href="../../io/configuration/tutorial_read_configuration.html"><span class="doc">here</span></a>.</p>
<p>This notebook is based on the <a class="reference internal" href="../../io/configuration/components/models/index.html#built-in-structure-density-and-abundance"><span class="std std-ref">built-in TARDIS models</span></a>, but these parameters can also be input via <a class="reference internal" href="../../io/configuration/components/models/index.html#custom-model-configurations"><span class="std std-ref">custom model configurations</span></a>, the <a class="reference external" href="../../analyzing_tardis/configuration/components/models/index.rst#csvy-model">CSVY model</a> or the <a class="reference internal" href="../../analyzing_tardis/visualization/how_to_abundance_widget.html"><span class="doc">custom abundance
widget</span></a>.</p>
<section id="Shell-Structure">
<h2>Shell Structure<a class="headerlink" href="#Shell-Structure" title="Link to this heading">¶</a></h2>
<p>TARDIS models supernovae as expanding homologously. This means that at the beginning of the explosion, the supernova starts at a single point and proceeds to expand radially outward such that the ratio of the velocity of the ejecta to the distance from the ejecta to the supernova’s center is uniform throughout the supernova. As an example, if the outer edge of the ejecta moves outward at some velocity <span class="math notranslate nohighlight">\(v_\mathrm{boundary\_outer}\)</span>, the velocity of the ejecta half way between the outer edge
and the center would be <span class="math notranslate nohighlight">\(\frac{v_\mathrm{boundary\_outer}}{2}\)</span>. The animation below demonstrates this type of expansion.</p>
<p>TARDIS simulates radiative transfer between an inner boundary (the photosphere) and an outer boundary (the outer edge of the supernova ejecta). The velocity of the inner boundary <span class="math notranslate nohighlight">\(v_\mathrm{boundary\_inner}\)</span> and the velocity of the outer boundary <span class="math notranslate nohighlight">\(v_\mathrm{boundary\_outer}\)</span> are supplied in the configuration file, as well as the time after the explosion for which TARDIS is calculating the spectrum (<span class="math notranslate nohighlight">\(t_\mathrm{explosion}\)</span>). The radii of the inner and outer boundaries are
therefore calculated by <span class="math notranslate nohighlight">\(r_\mathrm{boundary\_inner}=v_\mathrm{boundary\_inner}*t_\mathrm{explosion}\)</span> and <span class="math notranslate nohighlight">\(r_\mathrm{boundary\_outer}=v_\mathrm{boundary\_outer}*t_\mathrm{explosion}\)</span>. Plasma at a distance <span class="math notranslate nohighlight">\(r\)</span> from the center of the supernova would then be traveling outward at a speed <span class="math notranslate nohighlight">\(v=\frac{r}{r_\mathrm{boundary\_outer}}v_\mathrm{boundary\_outer} = \frac{r}{t_\mathrm{explosion}}\)</span>. This is also shown in the animation.</p>
<p>Additionally, TARDIS divides the space between the inner and outer computational boundaries into cells – radial shells for which the state/condition of the ejecta is (spatially) constant. In the animation, 6 cells are shown, being divided by the light blue lines. As TARDIS is a time-independent code which calculates the spectra at an instant in time, the radii of the boundaries (either of the computational domain or of the cells) do not change throughout the simulation.</p>
<p><img alt="524c9abb76c84043afff37cf5ae4cd0b" class="no-scaled-link" src="../../_images/expansion_animation.gif" style="width: 500px;" /></p>
<p>We now demonstrate how the shell structure works using the TARDIS code.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We import the necessary packages</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.io.configuration.config_reader</span><span class="w"> </span><span class="kn">import</span> <span class="n">Configuration</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimulationState</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.io.atom_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">download_atom_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tardis.io.atom_data.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">AtomData</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>

<span class="c1"># We download the atomic data needed to run the simulation</span>
<span class="n">download_atom_data</span><span class="p">(</span><span class="s1">&#39;kurucz_cd23_chianti_H_He_latest&#39;</span><span class="p">)</span>
<span class="n">atom_data</span> <span class="o">=</span> <span class="n">AtomData</span><span class="o">.</span><span class="n">from_hdf</span><span class="p">(</span><span class="s1">&#39;kurucz_cd23_chianti_H_He_latest.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Atomic Data kurucz_cd23_chianti_H_He_latest already exists in /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He_latest.h5. Will not download - override with force_download=True.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up a base configuration to use throughout the notebook</span>
<span class="n">base_config</span> <span class="o">=</span> <span class="n">Configuration</span><span class="o">.</span><span class="n">from_yaml</span><span class="p">(</span><span class="s2">&quot;tardis_example.yml&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In the cell below, we set up a model. We use the <a class="reference internal" href="../../io/configuration/components/models/index.html#specific-structure"><span class="std std-ref">specific structure</span></a> where we supply <span class="math notranslate nohighlight">\(t_\mathrm{explosion}\)</span>, the velocity of the inner and outer boundaries of the supernova (labeled <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code>), and the number of shells (labeled <code class="docutils literal notranslate"><span class="pre">num</span></code>). The shells are then evenly spaced between the inner and outer boundaries of the supernova. The time after the explosion, the inner and outer velocities, and the number
of shells can be varied to get different shell structures. The <code class="docutils literal notranslate"><span class="pre">SimulationState</span></code> object stores information about the model in the following attributes: <code class="docutils literal notranslate"><span class="pre">velocity</span></code> shows the velocity of the shell boundaries, <code class="docutils literal notranslate"><span class="pre">v_inner</span></code> shows the velocities of the inner boundaries of each shell, <code class="docutils literal notranslate"><span class="pre">v_outer</span></code> shows the velocity of the outer boundaries of each shell, and <code class="docutils literal notranslate"><span class="pre">v_middle</span></code> shows the velocity of the middle of each shell. Similarly, <code class="docutils literal notranslate"><span class="pre">radius</span></code>, <code class="docutils literal notranslate"><span class="pre">r_inner</span></code>, <code class="docutils literal notranslate"><span class="pre">r_outer</span></code>, and <code class="docutils literal notranslate"><span class="pre">r_middle</span></code> show the radii
of each shell boundary, the inner boundaries, the outer boundaries, and the middles of each shell, respectively. <code class="docutils literal notranslate"><span class="pre">v_inner_boundary</span></code> shows the velocity of the inner boundary of the computational domain, and <code class="docutils literal notranslate"><span class="pre">v_outer_boundary</span></code> shows the velocity of the outer boundary of the computational domain. Finally, <code class="docutils literal notranslate"><span class="pre">volume</span></code> shows the volume of each shell, calculated via the formula of the volume of a spherical shell: <span class="math notranslate nohighlight">\(V=\frac{4}{3}\pi (r_\mathrm{outer}^3-r_\mathrm{inner}^3)\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shell_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">shell_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># This line is necessary to indicate we are using a built-in shell structure.</span>
<span class="c1"># Do not change it.</span>
<span class="n">shell_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;specific&#39;</span>

<span class="n">shell_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">shell_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">shell_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">shell_simulation_state</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">shell_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;velocity:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v_inner:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">v_inner</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v_outer:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">v_outer</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v_middle:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">v_middle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v_inner_boundary:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">v_inner_boundary</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v_outer_boundary:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">v_outer_boundary</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;radius:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r_inner:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">r_inner</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r_outer:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">r_outer</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;r_middle:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">r_middle</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;volume:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shell_simulation_state</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
velocity:
 [1.00e+08 1.05e+08 1.10e+08 1.15e+08 1.20e+08 1.25e+08 1.30e+08 1.35e+08
 1.40e+08 1.45e+08 1.50e+08 1.55e+08 1.60e+08 1.65e+08 1.70e+08 1.75e+08
 1.80e+08 1.85e+08 1.90e+08 1.95e+08 2.00e+08] cm / s
v_inner:
 [1.00e+08 1.05e+08 1.10e+08 1.15e+08 1.20e+08 1.25e+08 1.30e+08 1.35e+08
 1.40e+08 1.45e+08 1.50e+08 1.55e+08 1.60e+08 1.65e+08 1.70e+08 1.75e+08
 1.80e+08 1.85e+08 1.90e+08 1.95e+08] cm / s
v_outer:
 [1.05e+08 1.10e+08 1.15e+08 1.20e+08 1.25e+08 1.30e+08 1.35e+08 1.40e+08
 1.45e+08 1.50e+08 1.55e+08 1.60e+08 1.65e+08 1.70e+08 1.75e+08 1.80e+08
 1.85e+08 1.90e+08 1.95e+08 2.00e+08] cm / s
v_middle:
 [1.025e+08 1.075e+08 1.125e+08 1.175e+08 1.225e+08 1.275e+08 1.325e+08
 1.375e+08 1.425e+08 1.475e+08 1.525e+08 1.575e+08 1.625e+08 1.675e+08
 1.725e+08 1.775e+08 1.825e+08 1.875e+08 1.925e+08 1.975e+08] cm / s
v_inner_boundary:
 100000000.0 cm / s
v_outer_boundary:
 200000000.0 cm / s
radius:
 [8.6400e+13 9.0720e+13 9.5040e+13 9.9360e+13 1.0368e+14 1.0800e+14
 1.1232e+14 1.1664e+14 1.2096e+14 1.2528e+14 1.2960e+14 1.3392e+14
 1.3824e+14 1.4256e+14 1.4688e+14 1.5120e+14 1.5552e+14 1.5984e+14
 1.6416e+14 1.6848e+14 1.7280e+14] cm
r_inner:
 [8.6400e+13 9.0720e+13 9.5040e+13 9.9360e+13 1.0368e+14 1.0800e+14
 1.1232e+14 1.1664e+14 1.2096e+14 1.2528e+14 1.2960e+14 1.3392e+14
 1.3824e+14 1.4256e+14 1.4688e+14 1.5120e+14 1.5552e+14 1.5984e+14
 1.6416e+14 1.6848e+14] cm
r_outer:
 [9.0720e+13 9.5040e+13 9.9360e+13 1.0368e+14 1.0800e+14 1.1232e+14
 1.1664e+14 1.2096e+14 1.2528e+14 1.2960e+14 1.3392e+14 1.3824e+14
 1.4256e+14 1.4688e+14 1.5120e+14 1.5552e+14 1.5984e+14 1.6416e+14
 1.6848e+14 1.7280e+14] cm
r_middle:
 [8.8560e+13 9.2880e+13 9.7200e+13 1.0152e+14 1.0584e+14 1.1016e+14
 1.1448e+14 1.1880e+14 1.2312e+14 1.2744e+14 1.3176e+14 1.3608e+14
 1.4040e+14 1.4472e+14 1.4904e+14 1.5336e+14 1.5768e+14 1.6200e+14
 1.6632e+14 1.7064e+14] cm
volume:
 [4.25848318e+41 4.68399379e+41 5.12976681e+41 5.59580224e+41
 6.08210009e+41 6.58866034e+41 7.11548300e+41 7.66256807e+41
 8.22991555e+41 8.81752544e+41 9.42539775e+41 1.00535325e+42
 1.07019296e+42 1.13705891e+42 1.20595111e+42 1.27686954e+42
 1.34981422e+42 1.42478513e+42 1.50178229e+42 1.58080569e+42] cm3
</pre></div></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">=</span> <span class="pre">velocity*time_explosion</span></code>, and similarly for <code class="docutils literal notranslate"><span class="pre">r_inner</span></code>, <code class="docutils literal notranslate"><span class="pre">r_outer</span></code>, and <code class="docutils literal notranslate"><span class="pre">r_middle</span></code>. You can get the radius of the photosphere via <code class="docutils literal notranslate"><span class="pre">v_inner_boundary*time_explosion</span></code> and outer edge of the supernova via <code class="docutils literal notranslate"><span class="pre">v_boundary_outer*time_explosion</span></code>.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Note</p>
<p>Using the built-in shell structure, as shown here, the shells are all equally spaced. This is not necessarily the case if one uses the <a class="reference internal" href="../../io/configuration/components/models/index.html#file-structure"><span class="std std-ref">file structure</span></a>, <a class="reference internal" href="../../io/configuration/components/models/index.html#csvy-model"><span class="std std-ref">CSVY model</span></a>, or <a class="reference internal" href="../../analyzing_tardis/visualization/how_to_abundance_widget.html"><span class="doc">custom abundance widget</span></a>.</p>
</div>
</section>
<section id="Density">
<h2>Density<a class="headerlink" href="#Density" title="Link to this heading">¶</a></h2>
<p>We now look at how TARDIS models the density inside each shell. If you use the <a class="reference internal" href="../../io/configuration/components/models/index.html#density"><span class="std std-ref">built-in densities</span></a>, TARDIS allows you to choose between the four models discussed below. The <a class="reference internal" href="../../io/configuration/components/models/index.html#file-structure"><span class="std std-ref">file structure</span></a>, <a class="reference internal" href="../../io/configuration/components/models/index.html#csvy-model"><span class="std std-ref">CSVY model</span></a>, and <a class="reference external" href="../../io/visualization/how_to_abundance_widget.ipynb">custom abundance widget</a> options
allow more freedom in assigning densities to each shell.</p>
<p>In general, the density in the supernova at a specific moment in time is a function of the radius or velocity of the ejecta (either can be used, since the radius and velocity are linearly related at any moment of time). Since the shell velocities do not change over time, it is more simple to write the densities as a function of ejecta velocity. If we do this, the time-dependence of the density is simple. We know the total mass of the ejecta is constant in each shell due to the nature of
homologous expansion. The inner and outer radii of each shell increase linearly over time, meaning the volume increases as time cubed. Since density is mass divided by volume, the density is inverse-cubic in time. Mathematically, if <span class="math notranslate nohighlight">\(\rho(v,t_\mathrm{explosion})\)</span> is the density at a velocity <span class="math notranslate nohighlight">\(v\)</span> after a time <span class="math notranslate nohighlight">\(t_\mathrm{explosion}\)</span>, given some characteristic time <span class="math notranslate nohighlight">\(t_0\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\rho(v,t_\mathrm{explosion})=\rho(v,t_0)*\left(\frac{t_0}{t_\mathrm{explosion}}\right)^3\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho(v,t_0)\)</span> is the density at <span class="math notranslate nohighlight">\(t_\mathrm{explosion}=t_0\)</span>. Notice that this gives the desired time dependence – for example, at <span class="math notranslate nohighlight">\(t_\mathrm{explosion}=2t_0\)</span>, <span class="math notranslate nohighlight">\(\rho(v,t_\mathrm{explosion})=\rho(v,t_0)/8\)</span>, exactly an inverse-cube relationship.</p>
<p>Since the state of the ejecta, including the density, is the same throughout the shell, we determine the shell’s density by plugging the velocity/radius at the center of the shell into the density function. We now explore the various built-in density profiles. For each profile, we build an example model using the density profile and example parameters (which can be varied in interactive mode), print the densities in each shell, and show a graph of density versus radius (specifically the radius
at the center of each shell).</p>
<p>Note that the density in each shell is stored in the <code class="docutils literal notranslate"><span class="pre">density</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">SimulationState</span></code> object.</p>
<section id="Branch85-W7-Density">
<h3>Branch85 W7 Density<a class="headerlink" href="#Branch85-W7-Density" title="Link to this heading">¶</a></h3>
<p>The first built-in density profile is the well-known W7 density model. There are no density-specific parameters that should be edited (see <a class="reference internal" href="../../io/configuration/components/models/index.html#branch85-w7-density"><span class="std std-ref">here</span></a> for the default values) as this is a well-established model. The shell structure can be varied as usual to see the effects of the shell structure on the W7 density.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w7_density_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">w7_density_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># This line is necessary to indicate we are using a built-in shell structure</span>
<span class="c1"># and density. Do not change it.</span>
<span class="n">w7_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;specific&#39;</span>

<span class="n">w7_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">w7_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">w7_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">w7_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;branch85_w7&#39;</span>

<span class="n">w7_density_model</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">w7_density_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;density:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">w7_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w7_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span> <span class="n">w7_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radius (</span><span class="si">{</span><span class="n">w7_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density (</span><span class="si">{</span><span class="n">w7_density_model</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
density:
 [3.13040297e-06 2.24289041e-06 1.63154722e-06 1.20337847e-06
 8.98906836e-07 6.79353803e-07 5.18986614e-07 4.00450110e-07
 3.11862570e-07 2.44975787e-07 1.93989578e-07 1.54775921e-07
 1.24363732e-07 1.00592042e-07 8.18735475e-08 6.70314791e-08
 5.51857848e-08 4.56728802e-08 3.79885019e-08 3.17466281e-08] g / cm3
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/physics_walkthrough_setup_model_7_2.svg" src="../../_images/physics_walkthrough_setup_model_7_2.svg" />
</div>
</div>
<p>In the cell below, we show the time dependence of the W7 density profile by comparing the density plots for models at two different times.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w7_modified_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">w7_density_config</span><span class="p">)</span>

<span class="n">w7_modified_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="n">w7_modified_model</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">w7_modified_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;density:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">w7_modified_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w7_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span>
         <span class="n">w7_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t_explosion = </span><span class="si">{</span><span class="n">w7_density_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w7_modified_model</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span>
         <span class="n">w7_modified_model</span><span class="o">.</span><span class="n">density</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t_explosion = </span><span class="si">{</span><span class="n">w7_modified_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radius (</span><span class="si">{</span><span class="n">w7_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density (</span><span class="si">{</span><span class="n">w7_density_model</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
density:
 [1.81157579e-06 1.29796899e-06 9.44182418e-07 6.96399579e-07
 5.20200716e-07 3.93144562e-07 3.00339476e-07 2.31741962e-07
 1.80476024e-07 1.41768395e-07 1.12262487e-07 8.95693988e-08
 7.19697525e-08 5.82129873e-08 4.73805252e-08 3.87913652e-08
 3.19362180e-08 2.64310649e-08 2.19840868e-08 1.83718913e-08] g / cm3
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/physics_walkthrough_setup_model_9_2.svg" src="../../_images/physics_walkthrough_setup_model_9_2.svg" />
</div>
</div>
<p>For the other density models described below, time dependence works similarly, and readers are encouraged to test out how they change over time. However, for brevity, we omit more explicit examples in this notebook.</p>
</section>
<section id="Uniform-Density">
<h3>Uniform Density<a class="headerlink" href="#Uniform-Density" title="Link to this heading">¶</a></h3>
<p>The uniform density profile sets the density in each shell to a constant value (with respect to velocity/radius). That is,</p>
<div class="math notranslate nohighlight">
\[\rho(v,t_0)=\mathrm{value}\]</div>
<p>and thus</p>
<div class="math notranslate nohighlight">
\[\rho(v,t_\mathrm{explosion})=\mathrm{value}*\left(\frac{t_0}{t_\mathrm{explosion}}\right)^3.\]</div>
<p>The parameters that can be varied, besides the shell structure, are thus the characteristic time <span class="math notranslate nohighlight">\(t_0\)</span>, and the value of the density at time <span class="math notranslate nohighlight">\(t_0\)</span>. The schema can be found <a class="reference internal" href="../../io/configuration/components/models/index.html#uniform-density"><span class="std std-ref">here</span></a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uni_density_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">uni_density_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># This line is necessary to indicate we are using a built-in shell structure</span>
<span class="c1"># and density. Do not change it.</span>
<span class="n">uni_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;specific&#39;</span>

<span class="n">uni_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">uni_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">uni_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">uni_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;uniform&#39;</span>
<span class="n">uni_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">time_0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>
<span class="n">uni_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">5e-10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>

<span class="n">uni_density_model</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">uni_density_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;density:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">uni_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">uni_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span> <span class="n">uni_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radius (</span><span class="si">{</span><span class="n">uni_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density (</span><span class="si">{</span><span class="n">uni_density_model</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
density:
 [5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10
 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10 5.e-10] g / cm3
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/physics_walkthrough_setup_model_12_2.svg" src="../../_images/physics_walkthrough_setup_model_12_2.svg" />
</div>
</div>
</section>
<section id="Power-Law-Density">
<h3>Power Law Density<a class="headerlink" href="#Power-Law-Density" title="Link to this heading">¶</a></h3>
<p>The power law density profile uses the following equation:</p>
<div class="math notranslate nohighlight">
\[\rho(v,t_0)=\rho_0\left(\frac{v}{v_0}\right)^{\rm exponent}\]</div>
<p>and thus</p>
<div class="math notranslate nohighlight">
\[\rho(v,t_\mathrm{explosion})=\rho_0\left(\frac{v}{v_0}\right)^{\rm exponent}\left(\frac{t_0}{t_\mathrm{explosion}}\right)^3.\]</div>
<p>Thus, the relevant parameters are <span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(\rho_0\)</span>, <span class="math notranslate nohighlight">\(v_0\)</span>, and the exponent. We recommend that the exponent be negative for a sensible density profile. The schema can be found <a class="reference internal" href="../../io/configuration/components/models/index.html#power-law-density"><span class="std std-ref">here</span></a>.</p>
<p>Note here that <span class="math notranslate nohighlight">\(\rho_0\)</span> is the density at time <span class="math notranslate nohighlight">\(t_0\)</span> and velocity <span class="math notranslate nohighlight">\(v_0\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pow_density_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">pow_density_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># This line is necessary to indicate we are using a built-in shell structure</span>
<span class="c1"># and density.</span>
<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;specific&#39;</span>

<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;power_law&#39;</span>
<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">time_0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>
<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">rho_0</span> <span class="o">=</span> <span class="mf">5e-10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">v_0</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">pow_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">exponent</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">pow_density_model</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">pow_density_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;density:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">pow_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pow_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span> <span class="n">pow_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radius (</span><span class="si">{</span><span class="n">pow_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density (</span><span class="si">{</span><span class="n">pow_density_model</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
density:
 [1.18976800e-10 1.08166577e-10 9.87654321e-11 9.05387053e-11
 8.32986256e-11 7.68935025e-11 7.11997152e-11 6.61157025e-11
 6.15574023e-11 5.74547544e-11 5.37489922e-11 5.03905266e-11
 4.73372781e-11 4.45533526e-11 4.20079815e-11 3.96746677e-11
 3.75304935e-11 3.55555556e-11 3.37325013e-11 3.20461465e-11] g / cm3
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/physics_walkthrough_setup_model_14_2.svg" src="../../_images/physics_walkthrough_setup_model_14_2.svg" />
</div>
</div>
</section>
<section id="Exponential-Density">
<h3>Exponential Density<a class="headerlink" href="#Exponential-Density" title="Link to this heading">¶</a></h3>
<p>The exponential density profile uses the following equation:</p>
<div class="math notranslate nohighlight">
\[\rho(v,t_0)=\rho_0e^{-v/v_0}\]</div>
<p>and thus</p>
<div class="math notranslate nohighlight">
\[\rho(v,t_\mathrm{explosion})=\rho_0e^{-v/v_0}\left(\frac{t_0}{t_\mathrm{explosion}}\right)^3.\]</div>
<p>Thus, the relevant parameters are <span class="math notranslate nohighlight">\(t_0\)</span>, <span class="math notranslate nohighlight">\(\rho_0\)</span>, and <span class="math notranslate nohighlight">\(v_0\)</span>. The schema can be found <a class="reference internal" href="../../io/configuration/components/models/index.html#exponential-density"><span class="std std-ref">here</span></a>.</p>
<p>Note here again that <span class="math notranslate nohighlight">\(\rho_0\)</span> is the density at time <span class="math notranslate nohighlight">\(t_0\)</span> and velocity <span class="math notranslate nohighlight">\(v_0\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exp_density_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">exp_density_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># This line is necessary to indicate we are using a built-in shell structure</span>
<span class="c1"># and density.</span>
<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;specific&#39;</span>

<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;exponential&#39;</span>
<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">time_0</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>
<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">rho_0</span> <span class="o">=</span> <span class="mf">5e-10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">**</span><span class="mi">3</span>
<span class="n">exp_density_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">v_0</span> <span class="o">=</span> <span class="mi">500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>

<span class="n">exp_density_model</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">exp_density_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;density:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">exp_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">exp_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span> <span class="n">exp_density_model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radius (</span><span class="si">{</span><span class="n">exp_density_model</span><span class="o">.</span><span class="n">r_middle</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Density (</span><span class="si">{</span><span class="n">exp_density_model</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
density:
 [6.43674518e-11 5.82420789e-11 5.26996123e-11 4.76845811e-11
 4.31467932e-11 3.90408330e-11 3.53256065e-11 3.19639306e-11
 2.89221604e-11 2.61698530e-11 2.36794622e-11 2.14260634e-11
 1.93871039e-11 1.75421771e-11 1.58728182e-11 1.43623198e-11
 1.29955644e-11 1.17588729e-11 1.06398682e-11 9.62735089e-12] g / cm3
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/physics_walkthrough_setup_model_16_2.svg" src="../../_images/physics_walkthrough_setup_model_16_2.svg" />
</div>
</div>
</section>
</section>
<section id="Abundance">
<h2>Abundance<a class="headerlink" href="#Abundance" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">SimulationState</span></code> also carries important information about elemental abundances in each shell. These are mass abundances – that is, the abundance of oxygen is the fraction of the shell’s mass that is made up of oxygen.</p>
<p>The only built-in abundance model that TARDIS offers is a uniform abundance, meaning each shell has identical abundances. Like density, however, the <a class="reference internal" href="../../io/configuration/components/models/index.html#file-abundance"><span class="std std-ref">file abundance</span></a>, <a class="reference internal" href="../../io/configuration/components/models/index.html#csvy-model"><span class="std std-ref">CSVY model</span></a>, and <a class="reference internal" href="../../analyzing_tardis/visualization/how_to_abundance_widget.html"><span class="doc">custom abundance widget</span></a> methods allow users more freedom with assigning different abundances in each
shell.</p>
<p>A table of abundances in each shell is stored in the <code class="docutils literal notranslate"><span class="pre">abundance</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">SimulationState</span></code> object.</p>
<p>In this first example, the abundances in each shell do not depend on the time after the explosion and are identical to those provided in the configuration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abund_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">abund_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># We add the abundances in this form to overwrite the elements in the</span>
<span class="c1"># base configuration.</span>
<span class="n">abund_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">abundances</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span>
  <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mf">.2</span><span class="p">,</span>
  <span class="s1">&#39;Ca&#39;</span><span class="p">:</span><span class="mf">.25</span><span class="p">,</span>
  <span class="s1">&#39;Mg&#39;</span><span class="p">:</span><span class="mf">.15</span><span class="p">,</span>
  <span class="s1">&#39;Si&#39;</span><span class="p">:</span><span class="mf">.3</span><span class="p">,</span>
  <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="mf">.1</span><span class="p">,</span>
  <span class="s1">&#39;model_isotope_time_0&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="p">}</span>

<span class="n">abund_model</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">abund_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="n">abund_model</span><span class="o">.</span><span class="n">abundance</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
    <tr>
      <th>atomic_number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
      <td>0.10</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
      <td>0.15</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
      <td>0.30</td>
    </tr>
    <tr>
      <th>20</th>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
      <td>0.25</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>In the next example, we show how TARDIS handles radioactive isotopes which are often present in supernovae. Specific isotopes such as <code class="docutils literal notranslate"><span class="pre">Ni56</span></code> (nickel-56 with 28 protons and 28 neutrons) or <code class="docutils literal notranslate"><span class="pre">Cr51</span></code> (chromium-51 with 24 protons and 27 neutrons) can be provided in the configuration.</p>
<p>If any radioactive isotope is provided, the abundances provided are assumed to be the abundances at the time of the explosion. TARDIS then uses <a class="reference external" href="https://radioactivedecay.github.io/">radioactivedecay</a> to calculate the decay products of these isotopes after a time <span class="math notranslate nohighlight">\(t_\mathrm{explosion}\)</span>. This is demonstrated in the example below.</p>
<p>If an isotope mass number is not supplied, TARDIS uses the most stable form of the atom (for example, <code class="docutils literal notranslate"><span class="pre">Ni</span></code> refers to the stable nickel-58).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abund_isotopes_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">abund_isotopes_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="n">abund_isotopes_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">abund_isotopes_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">abundances</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;O&#39;</span><span class="p">:</span><span class="mf">.3</span><span class="p">,</span>
                                            <span class="s1">&#39;Ni56&#39;</span><span class="p">:</span><span class="mf">.2</span><span class="p">,</span>
                                            <span class="s1">&#39;Ni57&#39;</span><span class="p">:</span><span class="mf">.1</span><span class="p">,</span>
                                            <span class="s1">&#39;Cr51&#39;</span><span class="p">:</span><span class="mf">.4</span><span class="p">,</span>
                                            <span class="s1">&#39;model_isotope_time_0&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">}</span>

<span class="n">abund_isotopes_simulation_state</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">abund_isotopes_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="n">abund_isotopes_simulation_state</span><span class="o">.</span><span class="n">abundance</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
      <th>13</th>
      <th>14</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
    </tr>
    <tr>
      <th>atomic_number</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8</th>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
      <td>0.300000</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
      <td>0.088544</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
      <td>0.311455</td>
    </tr>
    <tr>
      <th>26</th>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
      <td>0.009002</td>
    </tr>
    <tr>
      <th>27</th>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
      <td>0.226150</td>
    </tr>
    <tr>
      <th>28</th>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
      <td>0.064835</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="Temperatures">
<h2>Temperatures<a class="headerlink" href="#Temperatures" title="Link to this heading">¶</a></h2>
<p>The model also includes information about the temperature of the photosphere/inner boundary, labeled as <span class="math notranslate nohighlight">\(T_\mathrm{inner}\)</span>, and the temperature of the plasma in each cell, called the radiative temperature and labeled as <span class="math notranslate nohighlight">\(T_\mathrm{rad}\)</span>. As will be explained, both of these quantities are be updated throughout the simulation, so the calculations in this section are the initial guesses.</p>
<p>TARDIS initially calculates <span class="math notranslate nohighlight">\(T_\mathrm{inner}\)</span> as the temperature of a <a class="reference external" href="https://en.wikipedia.org/wiki/Black-body_radiation">blackbody</a> such that the luminosity of the photosphere (see <a class="reference internal" href="../montecarlo/initialization.html"><span class="doc">initialization</span></a>) matches the requested output luminosity of the entire supernova <span class="math notranslate nohighlight">\(L_\mathrm{requested}\)</span>, which is specified in the <a class="reference internal" href="../../io/configuration/components/spectrum.html"><span class="doc">spectrum configuration</span></a>:</p>
<div class="math notranslate nohighlight">
\[T_{\mathrm{inner}}=\left(\frac{L_\mathrm{requested}}{4 \pi r_{\mathrm{boundary\_inner}}^2 \sigma_{\mathrm{R}}}\right)^{1/4}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{\mathrm{R}}\)</span> is the Stefan-Boltzmann constant and <span class="math notranslate nohighlight">\(r_{\mathrm{boundary\_inner}}\)</span> is once again the radius of the photosphere, calculated as part of the shell structure. Because of light-matter interactions, the output luminosity of the supernova will not be the same as the luminosity of the photosphere, so the photospheric temperature is updated throughout the simulation as part of the convergence process in order to match the output luminosity to the requested
luminosity (see <a class="reference internal" href="../update_and_conv/update_and_conv.html"><span class="doc">Updating Plasma and Convergence</span></a>).</p>
<p>Next, TARDIS calculates the initial guess for the radiative temperature in each shell. This temperature is also updated throughout the simulation based on light-matter interactions (see once again <a class="reference internal" href="../update_and_conv/update_and_conv.html"><span class="doc">Updating Plasma and Convergence</span></a>). The initial guess for <span class="math notranslate nohighlight">\(T_\mathrm{rad}\)</span> is calculated using <a class="reference external" href="https://en.wikipedia.org/wiki/Wien%27s_displacement_law">Wien’s Law</a>. Wien’s Law states that the temperature of a blackbody is inversely proportional to
the blackbody’s peak wavelength. The proportionality constant, labeled <span class="math notranslate nohighlight">\(b\)</span>, is approximately <span class="math notranslate nohighlight">\(2.898*10^{-3} m*K\)</span>. In equation form,</p>
<div class="math notranslate nohighlight">
\[T=\frac{b}{\lambda_\mathrm{peak}}.\]</div>
<p>Since we know <span class="math notranslate nohighlight">\(T_\mathrm{inner}\)</span> (from the previous calculation), at the photosphere, we have <span class="math notranslate nohighlight">\(\lambda_\mathrm{peak,inner}=\frac{b}{T_\mathrm{inner}}\)</span>. Now, when the ejecta is moving at a velocity <span class="math notranslate nohighlight">\(v\)</span>, <span class="math notranslate nohighlight">\(\lambda_\mathrm{peak}\)</span> is doppler shifted (in more technical language, we find the peak wavelength in the co-moving frame, see <a class="reference internal" href="../montecarlo/propagation.html#reference-frames"><span class="std std-ref">reference frames</span></a>). The doppler factor is (approximately) <span class="math notranslate nohighlight">\(1+\frac{\Delta v}{c}\)</span> where
<span class="math notranslate nohighlight">\(\Delta v\)</span> is the difference between <span class="math notranslate nohighlight">\(v\)</span> and the velocity at the photosphere (i.e. <span class="math notranslate nohighlight">\(\Delta v = v-v_\mathrm{boundary\_inner}\)</span>). So,</p>
<div class="math notranslate nohighlight">
\[\lambda_\mathrm{peak}(v)=\left(1+\frac{v-v_\mathrm{boundary\_inner}}{c}\right)\lambda_\mathrm{peak,inner}=\left(1+\frac{v-v_\mathrm{boundary\_inner}}{c}\right)\frac{b}{T_\mathrm{inner}}.\]</div>
<p>Thus, the temperature at a velocity <span class="math notranslate nohighlight">\(v\)</span> is</p>
<div class="math notranslate nohighlight">
\[T_\mathrm{rad}(v)=\frac{b}{\lambda_\mathrm{peak}(v)}=\frac{T_\mathrm{inner}}{1+\frac{v-v_\mathrm{boundary\_inner}}{c}}.\]</div>
<p>As with density, the radiative temperature is modeled as constant throughout the shell, so we determine the temperature of the shell based on the ejecta’s velocity at the center of the shell.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Note</p>
<p>Specific initial guesses for the photospheric and radiative temperatures not based on the above calculations can also be input in the <a class="reference internal" href="../../io/configuration/components/plasma.html"><span class="doc">plasma configuration</span></a> (for both) or in the <a class="reference internal" href="../../io/configuration/components/models/index.html#csvy-model"><span class="std std-ref">CSVY model</span></a> (radiative temperature only).</p>
</div>
<p>Using the parameters below, we print off the initial photospheric temperature and radiative temperature in each shell, and plot temperature versus radius, including a point for the temperature of the photosphere.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_rad_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">t_rad_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># In the configuration file, but not here, the luminosity requested can be</span>
<span class="c1"># given on a logarithmic scale based on the luminosity of the sun.</span>
<span class="n">t_rad_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">luminosity_requested</span> <span class="o">=</span> <span class="mf">4e44</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>

<span class="c1"># This line is necessary to indicate we are using a built-in shell structure</span>
<span class="c1"># and density. Do not change it.</span>
<span class="n">t_rad_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;specific&#39;</span>

<span class="n">t_rad_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">t_rad_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">t_rad_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">t_radiative_simulation_state</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">t_rad_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t_inner:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">t_inner</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;t_rad:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">t_radiative</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span> <span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">t_radiative</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">radius</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">t_inner</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radius (</span><span class="si">{</span><span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">r_middle</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radiative Temperature (</span><span class="si">{</span><span class="n">t_radiative_simulation_state</span><span class="o">.</span><span class="n">t_radiative</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
t_inner:
 93122.09836905584 K
t_rad:
 [93114.33346946 93098.80755443 93083.28681612 93067.77125196
 93052.26085936 93036.75563572 93021.25557846 93005.76068501
 92990.27095279 92974.78637921 92959.30696169 92943.83269767
 92928.36358457 92912.89961982 92897.44080085 92881.98712509
 92866.53858997 92851.09519294 92835.65693142 92820.22380286] K
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/physics_walkthrough_setup_model_22_2.svg" src="../../_images/physics_walkthrough_setup_model_22_2.svg" />
</div>
</div>
</section>
<section id="Dilution-Factor">
<h2>Dilution Factor<a class="headerlink" href="#Dilution-Factor" title="Link to this heading">¶</a></h2>
<p>The dilution factor <span class="math notranslate nohighlight">\(W\)</span> describes the fraction of the energy from a blackbody that “reaches” the observer. That is, it is the ratio of the energy density at the observer to the energy density of the blackbody. This heavily depends on light-matter interactions, as matter can shield or amplify the energy coming from the blackbody, in this case the photosphere. However, in the absence of other material, the dilution factor is purely geometric, called the geometric dilution factor. The
geometric dilution factor at a point is the fraction of the point’s “field of view” that the blackbody takes up, as shown in the figure below.</p>
<p><img alt="51aae8f20fc3465b8fb517be3625785b" class="no-scaled-link" src="../../_images/dilution_factor.png" style="width: 500px;" /></p>
<p>Using geometry (in 3D, where the photosphere in the figure is a sphere, not a circle), the fraction of the point’s “field of view” taken up by the sphere is</p>
<div class="math notranslate nohighlight">
\[\frac{1}{2}\left(1-\sqrt{1-\frac{r_\mathrm{boundary\_inner}^2}{r^2}}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(r_\mathrm{boundary\_inner}\)</span> is the radius of the circle in the picture (the photosphere in terms of TARDIS). This is the geometric dilution factor.</p>
<p>Like the radiative temperature, the dilution factor in each cell changes throughout the simulation based on the light-matter interactions (see <a class="reference internal" href="../update_and_conv/update_and_conv.html"><span class="doc">Updating Plasma and Convergence</span></a>). TARDIS uses the geometric dilution factor as the initial guess for the dilution factor in each cell, plugging in the radius at the center of the cell to determine the initial dilution factor in the cell.</p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Note</p>
<p>An initial guess for the dilution factor in each cell not based on the geometric dilution factor can be input via the <a class="reference internal" href="../../io/configuration/components/models/index.html#csvy-model"><span class="std std-ref">CSVY model</span></a>.</p>
</div>
<p>We print off the dilution factor in each cell and plot the dilution factor versus radius for a certain shell structure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dilution_factor_config</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_config</span><span class="p">)</span>

<span class="n">dilution_factor_config</span><span class="o">.</span><span class="n">supernova</span><span class="o">.</span><span class="n">time_explosion</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">day</span>

<span class="c1"># This line is necessary to indicate we are using a built-in shell structure</span>
<span class="c1"># and density. Do not change it.</span>
<span class="n">dilution_factor_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="s1">&#39;specific&#39;</span>

<span class="n">dilution_factor_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">dilution_factor_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">stop</span> <span class="o">=</span> <span class="mi">2000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span>
<span class="n">dilution_factor_config</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">velocity</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">dilution_factor_simulation_state</span> <span class="o">=</span> <span class="n">SimulationState</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span><span class="n">dilution_factor_config</span><span class="p">,</span> <span class="n">atom_data</span><span class="o">=</span><span class="n">atom_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;dilution_factor: </span><span class="si">{</span><span class="n">dilution_factor_simulation_state</span><span class="o">.</span><span class="n">dilution_factor</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dilution_factor_simulation_state</span><span class="o">.</span><span class="n">r_middle</span><span class="p">,</span> <span class="n">dilution_factor_simulation_state</span><span class="o">.</span><span class="n">dilution_factor</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Radius (</span><span class="si">{</span><span class="n">dilution_factor_simulation_state</span><span class="o">.</span><span class="n">r_middle</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dilution Factor&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Number of density points larger than number of shells. Assuming inner point irrelevant
model_isotope_time_0 is not set in the configuration. Isotopic mass fractions will not be decayed and is assumed to be correct for the time_explosion. THIS IS NOT RECOMMENDED!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dilution_factor: [0.3902439  0.31651472 0.27093858 0.23746888 0.21120466 0.1898178
 0.17197474 0.15682571 0.14379052 0.13245342 0.12250561 0.11371132
 0.10588651 0.09888494 0.09258861 0.08690114 0.08174289 0.07704742
 0.07275885 0.06882984]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/physics_walkthrough_setup_model_24_2.svg" src="../../_images/physics_walkthrough_setup_model_24_2.svg" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="setup_example.html" class="btn btn-neutral float-left" title="Setup Example" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="plasma/index.html" class="btn btn-neutral float-right" title="Plasma" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 12 Oct 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>