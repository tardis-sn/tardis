

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Benchmarking Information &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=743ecc6b"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.13/dist/embed-amd.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Features In-Progress" href="../in_progress/index.html" />
    <link rel="prev" title="Profiling the effect of input parameters on TARDIS runtime" href="profiling/tardis_profiling_threads.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/high_energy/run_high_energy_workflow.html">TARDIS High Energy Workflow Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/visualization/tutorial_montecarlo_packet_visualization.html">Montecarlo Packet Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/index.html">Analyszing TARDIS Simulation Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/tutorial_read_configuration.html">Reading a Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how-to/code_comparison/index.html">How to do Code Comparison using TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../physics_walkthrough/intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics_walkthrough/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics_walkthrough/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics_walkthrough/update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics_walkthrough/spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics_walkthrough/tardisgamma/index.html">TARDIS-High Energy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/visualization_reference.html">Visualization Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/hdf/index.html">Hierarchical Data Format (HDF5) Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">Bibliography and Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Developer Workflow</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hdf_writer.html">Example Usage of HDFWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="isotope_pd_subclass.html">Extending Pandas DataFrame Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="profiling/index.html">Profiling Information</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Benchmarking Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Setting-up-asv">Setting up asv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Running-the-benchmarks">Running the benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Writing-Benchmarks">Writing Benchmarks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../in_progress/index.html">Features In-Progress</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Developer Tools</a></li>
      <li class="breadcrumb-item active">Benchmarking Information</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/contributing/tools/benchmark.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
    /* strip stderr */
    div.nboutput.container div.output_area.stderr {
        background: #fdd;
        display: none;
    }

    .launch-btn {
        background-color: #2980B9;
        border: none;
        border-radius: 4px;
        color: #fcfcfc;
        font-family: inherit;
        text-decoration: none;
        padding: 3px 8px;
        letter-spacing: 0.03em;
        display: inline-block;
        line-height: 1.5em;
    }

    .launch-btn:hover {
        background-color: #1b6391;
        color: #fcfcfc;
    }

    .launch-btn:visited {
        color: #fcfcfc;
    }

    .note-p {
        margin-bottom: 0.4em;
        line-height: 2em;
    }
</style>

<div class="admonition note">
<p class="note-p">You can interact with this notebook online: <a href="https://mybinder.org/v2/gh/tardis-sn/tardis/HEAD?filepath=docs/contributing/tools/benchmark.ipynb" class="launch-btn" target="_blank" rel="noopener noreferrer">Launch notebook</a></p>
</div><section id="Benchmarking-Information">
<h1>Benchmarking Information<a class="headerlink" href="#Benchmarking-Information" title="Link to this heading">¶</a></h1>
<p>A benchmark is a comparison of the performance of code along commit history. It is a way to measure the performance of the code and to ensure that the code is not getting slower. In this notebook, we will be understanding the best ways to write benchmarks and how to run them. Throughout the notebook, we will be using the <code class="docutils literal notranslate"><span class="pre">asv</span></code> package for benchmarking.</p>
<section id="Setting-up-asv">
<h2>Setting up asv<a class="headerlink" href="#Setting-up-asv" title="Link to this heading">¶</a></h2>
<p>Prior to installing asv, you need to set up a conda environment and install conda-build. You can do this by running the following commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>conda activate base
conda install conda-build
</pre></div>
</div>
<p>After running the above commands, you can install asv by running the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install asv
</pre></div>
</div>
</section>
<section id="Running-the-benchmarks">
<h2>Running the benchmarks<a class="headerlink" href="#Running-the-benchmarks" title="Link to this heading">¶</a></h2>
<p>To run the benchmarks, you can run the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>asv run
</pre></div>
</div>
<p>This command will run for last 2 commits. asv can also run for a specific commit or a range of commits which can be done by running the following commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">asv</span> <span class="pre">run</span> <span class="pre">&lt;tag/branch&gt;^!</span></code> runs for the last commit for the given tag/branch.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">asv</span> <span class="pre">run</span> <span class="pre">master..mybranch</span></code> runs for the commits between master and mybranch.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">asv</span> <span class="pre">run</span> <span class="pre">HASHFILE:hashestobenchmark.txt</span></code> runs for the commits in the file hashestobenchmark.txt where each line is a commit hash.</p></li>
</ul>
<p>Some of the important commands of asv are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--quick</span></code> quickly runs the benchmarks.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-e</span></code> shows errors in the benchmark.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--bench</span> <span class="pre">&lt;file&gt;</span></code> runs the benchmarks only for the given file. The extension of the file should not be included.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--skip-existing-successful</span></code> skips the benchmarks that have already been run successfully.</p></li>
</ul>
<p>Example: <code class="docutils literal notranslate"><span class="pre">asv</span> <span class="pre">run</span> <span class="pre">master^!</span> <span class="pre">--quick</span> <span class="pre">-e</span> <span class="pre">--bench</span> <span class="pre">run_tardis</span></code></p>
<p>To view the result in a website, you can run the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>asv publish
asv preview
</pre></div>
</div>
<p>In order to run the tardis benchmarks, you need to change <code class="docutils literal notranslate"><span class="pre">atomic_data_fname</span></code> function in <a class="reference external" href="https://github.com/tardis-sn/tardis/blob/master/benchmarks/benchmark_base.py">benchmark_base.py</a> file and download the atomic_data. Here are the changes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">atomic_data_fname</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">tardis.io.configuration.config_internal</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_data_dir</span>

    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">get_data_dir</span><span class="p">()</span>
    <span class="n">atomic_data_fname</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/kurucz_cd23_chianti_H_He_latest.h5&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">Path</span><span class="p">(</span><span class="n">atomic_data_fname</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="n">atom_data_missing_str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">atomic_data_fname</span><span class="si">}</span><span class="s2"> atomic datafiles &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;does not seem to exist&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">atom_data_missing_str</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">atomic_data_fname</span>
</pre></div>
</div>
<p>After this you need to download the atomic data file which can be done by running the following file:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tardis.io.atom_data</span><span class="w"> </span><span class="kn">import</span> <span class="n">download_atom_data</span>

<span class="n">download_atom_data</span><span class="p">(</span><span class="s1">&#39;kurucz_cd23_chianti_H_He_latest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Atomic Data kurucz_cd23_chianti_H_He_latest already exists in /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He_latest.h5. Will not download - override with force_download=True.
</pre></div></div>
</div>
</section>
<section id="Writing-Benchmarks">
<h2>Writing Benchmarks<a class="headerlink" href="#Writing-Benchmarks" title="Link to this heading">¶</a></h2>
<p>TARDIS has adopted a class way of writing benchmarks. You can browse the benchmarks directory in the tardis repository to understand how the benchmarks are written. Here are some of the important points to keep in mind while writing benchmarks:</p>
<ul class="simple">
<li><p>The naming of file must specify the directory along with the file. Mentioning the tardis directory is not required.</p></li>
<li><p>The class name should be the same as the file name with <code class="docutils literal notranslate"><span class="pre">Benchmark</span></code> prepended to it.</p></li>
<li><p>The class should inherit from <code class="docutils literal notranslate"><span class="pre">BenchmarkBase</span></code> if required.</p></li>
<li><p>Every class should have a <code class="docutils literal notranslate"><span class="pre">setup</span></code> function which is used to set up the environment for the benchmark. This is done so that we can avoid potential noise in the benchmarks. For example, if a function needs a parameter which needs some time to be set up, we can write it up in the <code class="docutils literal notranslate"><span class="pre">setup</span></code> function.</p></li>
<li><p>Common functions which can be inherited in multiple files in the future should be written in benchmark_base.py file.</p></li>
<li><p>The benchmark should be written in a function with the name <code class="docutils literal notranslate"><span class="pre">time_&lt;function_name&gt;</span></code>.</p></li>
<li><p>Based on the local run, setting up the <a class="reference external" href="https://asv.readthedocs.io/en/stable/tuning.html">repeat</a> might reduce time to run the benchmarks in the github actions. For example, if a benchmark takes less time to run then it might be a good idea to run that function for say 4 times but if a benchmark takes more time to run then it might be a good idea to run that function for 2 times.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="profiling/tardis_profiling_threads.html" class="btn btn-neutral float-left" title="Profiling the effect of input parameters on TARDIS runtime" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../in_progress/index.html" class="btn btn-neutral float-right" title="Features In-Progress" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 06 Oct 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>