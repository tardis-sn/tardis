

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Code Quality Guidelines &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.13/dist/embed-amd.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Developer FAQ" href="developer_faq.html" />
    <link rel="prev" title="Benchmarks" href="benchmarks.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../io/hdf/index.html">Hierarchical Data Format (HDF5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/model/index.html">Reading Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analyzing Tardis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/spectrum/index.html">Analyzing TARDIS Spectra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/liv_plot_notebook.html">Analyzing Last Interaction Velocity (LIV) Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/rpacket_plot_notebook.html">Analysing Montecarlo Packets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analyzing_tardis/analysing_convergence_plot.html">Convergence Plots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../physics/intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/tardisgamma/index.html">TARDIS-High Energy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Workflow</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="issues.html">Reporting Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_workflow.html">General Workflow to add a new feature</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_workflow.html#preparation-and-working-with-git">Preparation and Working with Git</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation_guidelines.html">Documentation Guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_tests.html">Running tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Code Quality Guidelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#code-style-conventions">Code Style Conventions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ruff">Ruff</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pre-commit-optional">Pre-commit (Optional)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#naming-conventions">Naming Conventions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#docstrings">Docstrings</a></li>
<li class="toctree-l3"><a class="reference internal" href="#edge-cases-and-exception-handling">Edge Cases and Exception Handling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="developer_faq.html">Developer FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tardis-core-team-instructions">TARDIS core team Instructions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../in_progress/index.html">Features In-Progress</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/code_comparison/index.html">Code Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">References and Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Developer Workflow</a></li>
      <li class="breadcrumb-item active">Code Quality Guidelines</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/contributing/development/code_quality.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="code-quality-guidelines">
<h1>Code Quality Guidelines<a class="headerlink" href="#code-quality-guidelines" title="Link to this heading">¶</a></h1>
<p>Code quality ensures that new developers will have an easier time understanding what previous developers have written. Hence, in an open-source software like TARDIS, writing quality code is essential. Quoting from <a class="reference external" href="https://realpython.com/python-code-quality">this RealPython article</a>, a high-quality code is identified by:</p>
<ul class="simple">
<li><p><strong>It does what it is supposed to do</strong> - code should perform the functions that it is written for.</p></li>
<li><p><strong>It does not contain defects or problems</strong> - things shouldn’t break on edge cases and defects should throw exceptions instead of causing unwanted behavior.</p></li>
<li><p><strong>It is easy to read, maintain, and extend</strong> - code should be easy to comprehend and it should be easy to add a new feature in it without disrupting previous features.</p></li>
</ul>
<section id="code-style-conventions">
<h2>Code Style Conventions<a class="headerlink" href="#code-style-conventions" title="Link to this heading">¶</a></h2>
<p>TARDIS follows the <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP 8</a> style guide written by the author of the Python programming language. It defines a consistent way to write your code making, it easier to read and maintain.</p>
<section id="ruff">
<h3>Ruff<a class="headerlink" href="#ruff" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://docs.astral.sh/ruff/">Ruff</a> is a code linter and formatter that checks for common mistakes and automatically fixes them. It is currently not installed in the TARDIS conda environment, so you will have to install it manually:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>conda install -c conda-forge ruff
</pre></div>
</div>
<p>To run Ruff, use the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>ruff check &lt;source_file_or_directory&gt; # Lints the code
ruff check &lt;source_file_or_directory&gt; --fix # Lints and fixes any fixable errors
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We adopt the linting rules utilized by astropy. Permanent rules are defined in the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>, non-permanent rules are defined in the <code class="docutils literal notranslate"><span class="pre">.ruff.toml</span></code> file. If you want to add a new rule, please add it to the <code class="docutils literal notranslate"><span class="pre">.ruff.toml</span></code> file. If you want to add a permanent rule, please open a PR to the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>.</p>
</div>
</section>
<section id="pre-commit-optional">
<h3>Pre-commit (Optional)<a class="headerlink" href="#pre-commit-optional" title="Link to this heading">¶</a></h3>
<p><a class="reference external" href="https://pre-commit.com/">Pre-commit</a> hooks are tools that help enforce quality standards by running checks on your code before you commit. If you choose to use pre-commit on your local machine, please follow these steps:</p>
<p>Install pre-commit by running:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install pre-commit
</pre></div>
</div>
<p>Set up the pre-commit hooks with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pre-commit install
</pre></div>
</div>
<p>This needs to be done only once per repository. The pre-commit hooks will now automatically run on each commit to ensure your changes meet our code quality standards.</p>
</section>
<section id="naming-conventions">
<h3>Naming Conventions<a class="headerlink" href="#naming-conventions" title="Link to this heading">¶</a></h3>
<p>While Ruff automatically conforms your code to a majority of the PEP 8 style guide (like whitespace usage, string quotes, code layout, etc.), your code still needs to conform to the <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/#naming-conventions">PEP 8 naming conventions</a>. The main things to keep in mind are:</p>
<ul class="simple">
<li><p>Function names should be lowercase, with words separated by underscores as necessary to improve readability (i.e. snake_case).</p></li>
<li><p>Variable names follow the same convention as function names.</p></li>
<li><p>Class names should use the CapWords convention.</p></li>
</ul>
</section>
</section>
<section id="docstrings">
<span id="id2"></span><h2>Docstrings<a class="headerlink" href="#docstrings" title="Link to this heading">¶</a></h2>
<p>A docstring (short for documentation string) is a string that describes a module’s, function’s, class’s, or method’s definition. The docstring is a special attribute of the object (<code class="docutils literal notranslate"><span class="pre">object.__doc__</span></code>) and, for consistency, is surrounded by triple double quotes. Besides helping others understand what your code does, docstrings are used by Sphinx to auto-generate <a class="reference external" href="https://tardis-sn.github.io/tardis/api/modules.html">API documentation</a>.</p>
<p>At TARDIS, we follow the <a class="reference external" href="https://numpydoc.readthedocs.io/en/latest/format.html">Numpy docstring format</a> - please go through this format guide before writing docstrings. The following is an example of a properly formatted docstring from the <a class="reference external" href="https://github.com/tardis-sn/tardis/blob/master/tardis/io/model_reader.py">model_reader</a> module of TARDIS:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">read_density_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filetype</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read different density file formats.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        file name or path of the density file</span>
<span class="sd">    filetype : str</span>
<span class="sd">        type of the density file</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    time_of_model : astropy.units.Quantity</span>
<span class="sd">        time at which the model is valid</span>
<span class="sd">    velocity : np.ndarray</span>
<span class="sd">        the array containing the velocities</span>
<span class="sd">    unscaled_mean_densities : np.ndarray</span>
<span class="sd">        the array containing the densities</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Code goes here</span>
</pre></div>
</div>
<p>Some of the important formatting conventions to note here are:</p>
<ul class="simple">
<li><p>The docstring should have no leading or trailing carriage returns, and there should be a carriage return between each segment.</p></li>
<li><p>At the start of the docstring there is a summary explaining the purpose of the function/class/module/method. This summary should follow standard English syntax, starting with a capitalized letter and ending with appropriate punctuation.</p></li>
<li><p>The docstring summary should not explain individual lines or the returns, it should summarize the purpose of the function/class/module. Comments on how individual lines work should be written using inline comments (<code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">comment</span></code>).</p></li>
<li><p>Variable, module, function, and class names should be written between single back-ticks ` `.</p></li>
<li><p>In the above example the return variable and type is specified. For the “Returns” section, the type must always be stated, even if the variable is not. The “Returns” section should follow the format of:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Returns</span>
<span class="sd">-------</span>
<span class="sd">(`optional variable name` : )type</span>
<span class="sd">    (optional descriptor)</span>
<span class="sd">&quot;&quot;&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The “Returns” section should not be included if the function/module/class does not have a return value(s).</p></li>
<li><p>Always list the full path for a variable type if it is not a built-in type, like in above example it is shown for <code class="docutils literal notranslate"><span class="pre">time_of_model</span></code>.</p></li>
</ul>
</section>
<section id="edge-cases-and-exception-handling">
<h2>Edge Cases and Exception Handling<a class="headerlink" href="#edge-cases-and-exception-handling" title="Link to this heading">¶</a></h2>
<p>Code should be written with a bit of foresight to handle errors that can occur during its execution. If you know that an <a class="reference external" href="https://docs.python.org/3/tutorial/errors.html">exception</a> is likely to occur in a certain case and can be dealt with accordingly, then your code should <a class="reference external" href="https://docs.python.org/3/tutorial/errors.html#handling-exceptions">handle</a> that exception. In another scenario, you may know that a particular edge case might cause your code to break, then you should <a class="reference external" href="https://docs.python.org/3/tutorial/errors.html#raising-exceptions">raise</a> an appropriate exception to describe what has gone wrong and terminate the program’s execution. An example of this in practice (taken from <a class="reference external" href="https://github.com/tardis-sn/tardis/blob/7d7c4bc4f99c909ff45070ae9576390d96734014/tardis/widgets/kromer_plot.py#L447-L451">here</a>) is featured below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_plotting_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">packets_mode</span><span class="p">,</span> <span class="n">packet_wvl_range</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">packets_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;virtual&quot;</span><span class="p">,</span> <span class="s2">&quot;real&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;Invalid value passed to packets_mode. Only &quot;</span>
            <span class="s2">&quot;allowed values are &#39;virtual&#39; or &#39;real&#39;&quot;</span>
        <span class="p">)</span>
    <span class="c1"># Rest of the code ...</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">packets_mode</span></code> parameter can only be string “virtual” or “real”. Thus, in case of an invalid value passed, it raises a specific exception (<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>) and informs the user of what the error is and how it can be resolved. Aside from raising exception an exception, this method safely returns without executing code with an invalid parameter value which would have caused unwanted behaviour.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="benchmarks.html" class="btn btn-neutral float-left" title="Benchmarks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="developer_faq.html" class="btn btn-neutral float-right" title="Developer FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 19 May 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>