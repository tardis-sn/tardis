

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>tardis.transport.montecarlo.packet_source package &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../_static/tardis_logo.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=4f4c52da"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.13/dist/embed-amd.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="tardis.transport.montecarlo.packet_source.base module" href="tardis.transport.montecarlo.packet_source.base.html" />
    <link rel="prev" title="tardis.transport.montecarlo.estimators.util module" href="tardis.transport.montecarlo.estimators.util.html" />
    <link href="../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tardis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/credits.html">Credits &amp; Publication Policies</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/high_energy/run_high_energy_workflow.html">TARDIS High Energy Workflow Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzing_tardis/visualization/tutorial_montecarlo_packet_visualization.html">Montecarlo Packet Visualization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../analyzing_tardis/index.html">Analyszing TARDIS Simulation Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/configuration/tutorial_read_configuration.html">Reading a Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/output/index.html">Additional Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../how-to/code_comparison/index.html">How to do Code Comparison using TARDIS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../physics_walkthrough/intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics_walkthrough/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics_walkthrough/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics_walkthrough/update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics_walkthrough/spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../physics_walkthrough/tardisgamma/index.html">TARDIS-High Energy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="tardis.html">tardis package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="tardis.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="tardis.energy_input.html">tardis.energy_input package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.grid.html">tardis.grid package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.gui.html">tardis.gui package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.io.html">tardis.io package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.model.html">tardis.model package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.opacities.html">tardis.opacities package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.plasma.html">tardis.plasma package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.scripts.html">tardis.scripts package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.simulation.html">tardis.simulation package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.spectrum.html">tardis.spectrum package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.stats.html">tardis.stats package</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="tardis.transport.html">tardis.transport package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.util.html">tardis.util package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.visualization.html">tardis.visualization package</a></li>
<li class="toctree-l4"><a class="reference internal" href="tardis.workflows.html">tardis.workflows package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tardis.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.html#module-tardis">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/visualization_reference.html">Visualization Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/configuration/index.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io/hdf/index.html">Hierarchical Data Format (HDF5) Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/zreferences.html">Bibliography and Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">tardis</a></li>
          <li class="breadcrumb-item"><a href="tardis.html">tardis package</a></li>
          <li class="breadcrumb-item"><a href="tardis.transport.html">tardis.transport package</a></li>
          <li class="breadcrumb-item"><a href="tardis.transport.montecarlo.html">tardis.transport.montecarlo package</a></li>
      <li class="breadcrumb-item active">tardis.transport.montecarlo.packet_source package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/tardis.transport.montecarlo.packet_source.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tardis-transport-montecarlo-packet-source-package">
<h1>tardis.transport.montecarlo.packet_source package<a class="headerlink" href="#tardis-transport-montecarlo-packet-source-package" title="Link to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html">tardis.transport.montecarlo.packet_source.base module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource"><code class="docutils literal notranslate"><span class="pre">BasePacketSource</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.MAX_SEED_VAL"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.MAX_SEED_VAL</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.calculate_radfield_luminosity"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.calculate_radfield_luminosity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.create_packet_energies"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.create_packet_energies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.create_packet_mus"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.create_packet_mus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.create_packet_nus"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.create_packet_nus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.create_packet_radii"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.create_packet_radii()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.create_packet_velocities"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.create_packet_velocities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource.create_packets"><code class="docutils literal notranslate"><span class="pre">BasePacketSource.create_packets()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html">tardis.transport.montecarlo.packet_source.black_body module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.create_packet_energies"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.create_packet_energies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.create_packet_mus"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.create_packet_mus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.create_packet_nus"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.create_packet_nus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.create_packet_radii"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.create_packet_radii()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.create_packets"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.create_packets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.from_simulation_state"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.from_simulation_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.hdf_name"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.hdf_name</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.hdf_properties"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.hdf_properties</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource.set_temperature_from_luminosity"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSource.set_temperature_from_luminosity()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html">tardis.transport.montecarlo.packet_source.black_body_relativistic module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html#tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSourceRelativistic</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html#tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic.create_packet_energies"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSourceRelativistic.create_packet_energies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html#tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic.create_packet_mus"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSourceRelativistic.create_packet_mus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html#tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic.create_packets"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSourceRelativistic.create_packets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html#tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic.from_simulation_state"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSourceRelativistic.from_simulation_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html#tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic.hdf_properties"><code class="docutils literal notranslate"><span class="pre">BlackBodySimpleSourceRelativistic.hdf_properties</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_weighted.html">tardis.transport.montecarlo.packet_source.black_body_weighted module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_weighted.html#tardis.transport.montecarlo.packet_source.black_body_weighted.BlackBodyWeightedSource"><code class="docutils literal notranslate"><span class="pre">BlackBodyWeightedSource</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_weighted.html#tardis.transport.montecarlo.packet_source.black_body_weighted.BlackBodyWeightedSource.create_packet_energies"><code class="docutils literal notranslate"><span class="pre">BlackBodyWeightedSource.create_packet_energies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_weighted.html#tardis.transport.montecarlo.packet_source.black_body_weighted.BlackBodyWeightedSource.create_packet_nus"><code class="docutils literal notranslate"><span class="pre">BlackBodyWeightedSource.create_packet_nus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_weighted.html#tardis.transport.montecarlo.packet_source.black_body_weighted.BlackBodyWeightedSource.hdf_name"><code class="docutils literal notranslate"><span class="pre">BlackBodyWeightedSource.hdf_name</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_weighted.html#tardis.transport.montecarlo.packet_source.black_body_weighted.BlackBodyWeightedSource.hdf_properties"><code class="docutils literal notranslate"><span class="pre">BlackBodyWeightedSource.hdf_properties</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html">tardis.transport.montecarlo.packet_source.high_energy module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packet_directions"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packet_directions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packet_energies"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packet_energies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packet_mus"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packet_mus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packet_nus"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packet_nus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packet_times_uniform_energy"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packet_times_uniform_energy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packet_times_uniform_time"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packet_times_uniform_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packet_velocities"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packet_velocities()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.GammaRayPacketSource.create_packets"><code class="docutils literal notranslate"><span class="pre">GammaRayPacketSource.create_packets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.high_energy.html#tardis.transport.montecarlo.packet_source.high_energy.legacy_calculate_positron_fraction"><code class="docutils literal notranslate"><span class="pre">legacy_calculate_positron_fraction()</span></code></a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="module-tardis.transport.montecarlo.packet_source">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-tardis.transport.montecarlo.packet_source" title="Link to this heading">¶</a></h2>
<p>Packet source subpackage for TARDIS Monte Carlo transport.</p>
<p>This subpackage contains classes for generating packets with different
physical properties and distributions for Monte Carlo radiative transfer
simulations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tardis.transport.montecarlo.packet_source.</span></span><span class="sig-name descname"><span class="pre">BasePacketSource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_mode_enabled</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_second_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract base packet source.</p>
<p>This abstract base class defines the interface for packet sources used in
TARDIS Monte Carlo radiative transfer. Packet sources are responsible
for creating radiation packets with specific properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>base_seed</strong><span class="classifier">int, optional</span></dt><dd><p>Base seed for random number generator. Default is None.</p>
</dd>
<dt><strong>legacy_mode_enabled</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether to enable legacy mode for compatibility. Default is False.</p>
</dd>
<dt><strong>legacy_second_seed</strong><span class="classifier">int, optional</span></dt><dd><p>Secondary seed for global numpy rng (Deprecated: Legacy reasons only).
Default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>MAX_SEED_VAL</strong><span class="classifier">int</span></dt><dd><p>Maximum seed value allowed by numpy (2**32 - 1).</p>
</dd>
<dt><strong>base_seed</strong><span class="classifier">int or None</span></dt><dd><p>Base seed for random number generator.</p>
</dd>
<dt><strong>legacy_mode_enabled</strong><span class="classifier">bool</span></dt><dd><p>Whether legacy mode is enabled.</p>
</dd>
<dt><strong>rng</strong><span class="classifier">numpy.random.Generator</span></dt><dd><p>Random number generator instance.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.MAX_SEED_VAL">
<span class="sig-name descname"><span class="pre">MAX_SEED_VAL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4294967295</span></em><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.MAX_SEED_VAL" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.calculate_radfield_luminosity">
<span class="sig-name descname"><span class="pre">calculate_radfield_luminosity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v7.1)"><span class="pre">Quantity</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource.calculate_radfield_luminosity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.calculate_radfield_luminosity" title="Link to this definition">¶</a></dt>
<dd><p>Calculate inner luminosity from blackbody radiation.</p>
<p>Uses the Stefan-Boltzmann law to calculate the luminosity from
the inner boundary radius and temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd><p>Inner luminosity in erg/s.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_energies">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_packet_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource.create_packet_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_energies" title="Link to this definition">¶</a></dt>
<dd><p>Create packet energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array-like</dt><dd><p>Packet energy values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_mus">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_packet_mus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource.create_packet_mus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_mus" title="Link to this definition">¶</a></dt>
<dd><p>Create packet direction cosines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array-like</dt><dd><p>Packet direction cosine values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_nus">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_packet_nus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource.create_packet_nus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_nus" title="Link to this definition">¶</a></dt>
<dd><p>Create packet frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array-like</dt><dd><p>Packet frequency values.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_radii">
<span class="sig-name descname"><span class="pre">create_packet_radii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource.create_packet_radii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_radii" title="Link to this definition">¶</a></dt>
<dd><p>Create packet radii.</p>
<p>This method should be implemented by subclasses that create packets
with specific radii. Either this method or create_packet_velocities
should be implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array-like</dt><dd><p>Packet radii values.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If the method is not implemented by the subclass.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_velocities">
<span class="sig-name descname"><span class="pre">create_packet_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource.create_packet_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.create_packet_velocities" title="Link to this definition">¶</a></dt>
<dd><p>Create packet velocities.</p>
<p>This method should be implemented by subclasses that create packets
with specific velocities. Either this method or create_packet_radii
should be implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array-like</dt><dd><p>Packet velocity values.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd><p>If the method is not implemented by the subclass.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BasePacketSource.create_packets">
<span class="sig-name descname"><span class="pre">create_packets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed_offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="tardis.transport.montecarlo.packets.packet_collections.html#tardis.transport.montecarlo.packets.packet_collections.PacketCollection" title="tardis.transport.montecarlo.packets.packet_collections.PacketCollection"><span class="pre">PacketCollection</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/base.html#BasePacketSource.create_packets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BasePacketSource.create_packets" title="Link to this definition">¶</a></dt>
<dd><p>Generate packet properties as arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>seed_offset</strong><span class="classifier">int, optional</span></dt><dd><p>Offset added to the base seed for randomness across iterations.
Default is 0.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments passed to packet creation methods.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments passed to packet creation methods.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>PacketCollection</dt><dd><p>Collection containing packet radii, frequencies, directions,
energies, seeds, and radiation field luminosity.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tardis.transport.montecarlo.packet_source.</span></span><span class="sig-name descname"><span class="pre">BlackBodySimpleSource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource" title="tardis.transport.montecarlo.packet_source.base.BasePacketSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePacketSource</span></code></a>, <a class="reference internal" href="tardis.io.hdf_writer_mixin.html#tardis.io.hdf_writer_mixin.HDFWriterMixin" title="tardis.io.hdf_writer_mixin.HDFWriterMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDFWriterMixin</span></code></a></p>
<p>Simple packet source that generates blackbody packets for Monte Carlo simulations.</p>
<p>This class creates packets with properties derived from blackbody radiation,
including appropriate frequency distribution, uniform radii, and cosine-weighted
direction distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>radius</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>Initial packet radius. Default is None.</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>Blackbody temperature. Default is None.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments passed to the parent class.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>radius</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Initial packet radius.</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Blackbody temperature.</p>
</dd>
</dl>
</dd>
</dl>
<p>Initialize BlackBodySimpleSource.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>radius</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>Initial packet radius. Default is None.</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>Absolute temperature. Default is None.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">Any</span></dt><dd><p>Additional keyword arguments passed to parent class.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_energies">
<span class="sig-name descname"><span class="pre">create_packet_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v7.1)"><span class="pre">Quantity</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource.create_packet_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_energies" title="Link to this definition">¶</a></dt>
<dd><p>Create packet energies with uniform distribution.</p>
<p>Uniformly distribute energy in arbitrary units where the ensemble of
packets has total energy of 1 erg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd><p>Array of packet energies in erg.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_mus">
<span class="sig-name descname"><span class="pre">create_packet_mus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource.create_packet_mus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_mus" title="Link to this definition">¶</a></dt>
<dd><p>Create zero-limb-darkening packet direction cosines.</p>
<p>Direction cosines are distributed according to <span class="math notranslate nohighlight">\(\mu=\sqrt{z}\)</span>,
where <span class="math notranslate nohighlight">\(z \in [0, 1]\)</span> is uniformly distributed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Array of direction cosines for packets.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_nus">
<span class="sig-name descname"><span class="pre">create_packet_nus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v7.1)"><span class="pre">Quantity</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource.create_packet_nus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_nus" title="Link to this definition">¶</a></dt>
<dd><p>Create packet <span class="math notranslate nohighlight">\(\nu\)</span> distributed using the algorithm described in
Bjorkman &amp; Wood 2001 (page 4) which references
Carter &amp; Cashwell 1975:
First, generate a uniform random number, <span class="math notranslate nohighlight">\(\xi_0 \in [0, 1]\)</span> and
determine the minimum value of
<span class="math notranslate nohighlight">\(l, l_{\rm min}\)</span>, that satisfies the condition
.. math:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>\sum_{i=1}^{l} i^{-4} \ge {{\pi^4}\over{90}} m_0 \;.
</pre></div>
</div>
<p>Next obtain four additional uniform random numbers (in the range 0
to 1) <span class="math notranslate nohighlight">\(\xi_1, \xi_2, \xi_3, {\rm and } \xi_4\)</span>.
Finally, the packet frequency is given by
.. math:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>x = -\ln{(\xi_1\xi_2\xi_3\xi_4)}/l_{\rm min}\;.
</pre></div>
</div>
<p>where <span class="math notranslate nohighlight">\(x=h\nu/kT\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>l_samples</strong><span class="classifier">int</span></dt><dd><p>number of l_samples needed in the algorithm</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array of frequencies</dt><dd><p>numpy.ndarray</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_radii">
<span class="sig-name descname"><span class="pre">create_packet_radii</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v7.1)"><span class="pre">Quantity</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource.create_packet_radii"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packet_radii" title="Link to this definition">¶</a></dt>
<dd><p>Create packet radii.</p>
<p>All packets are created at the same radius (inner boundary).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd><p>Array of packet radii in CGS units.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packets">
<span class="sig-name descname"><span class="pre">create_packets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="tardis.transport.montecarlo.packets.packet_collections.html#tardis.transport.montecarlo.packets.packet_collections.PacketCollection" title="tardis.transport.montecarlo.packets.packet_collections.PacketCollection"><span class="pre">PacketCollection</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource.create_packets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.create_packets" title="Link to this definition">¶</a></dt>
<dd><p>Create packet collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>*args</strong><span class="classifier">Any</span></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">Any</span></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>PacketCollection</dt><dd><p>Collection of packets.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If radius or temperature is not set.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.from_simulation_state">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_simulation_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_state</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource" title="tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource"><span class="pre">BlackBodySimpleSource</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource.from_simulation_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.from_simulation_state" title="Link to this definition">¶</a></dt>
<dd><p>Create BlackBodySimpleSource from simulation state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>simulation_state</strong><span class="classifier">SimulationState</span></dt><dd><p>The simulation state object containing inner radius and temperature.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>BlackBodySimpleSource</dt><dd><p>New instance initialized with simulation state parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.hdf_name">
<span class="sig-name descname"><span class="pre">hdf_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'black_body_simple_source'</span></em><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.hdf_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.hdf_properties">
<span class="sig-name descname"><span class="pre">hdf_properties</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['radius',</span> <span class="pre">'temperature',</span> <span class="pre">'base_seed']</span></em><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.hdf_properties" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.set_temperature_from_luminosity">
<span class="sig-name descname"><span class="pre">set_temperature_from_luminosity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">luminosity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v7.1)"><span class="pre">Quantity</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body.html#BlackBodySimpleSource.set_temperature_from_luminosity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSource.set_temperature_from_luminosity" title="Link to this definition">¶</a></dt>
<dd><p>Set blackbody packet source temperature from luminosity.</p>
<p>Uses the Stefan-Boltzmann law to derive temperature from the given
luminosity and the source radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>luminosity</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Total luminosity to match.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tardis.transport.montecarlo.packet_source.</span></span><span class="sig-name descname"><span class="pre">BlackBodySimpleSourceRelativistic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_relativistic.html#BlackBodySimpleSourceRelativistic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource" title="tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlackBodySimpleSource</span></code></a>, <a class="reference internal" href="tardis.io.hdf_writer_mixin.html#tardis.io.hdf_writer_mixin.HDFWriterMixin" title="tardis.io.hdf_writer_mixin.HDFWriterMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDFWriterMixin</span></code></a></p>
<p>Relativistic blackbody packet source for Monte Carlo simulations.</p>
<p>This class generates blackbody packets with relativistic corrections
for sources that are moving with respect to the lab frame. It accounts
for the motion of the inner boundary where packets are created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time_explosion</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Time elapsed since explosion.</p>
</dd>
<dt><strong>radius</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Initial packet radius.</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Absolute temperature.</p>
</dd>
<dt><strong>base_seed</strong><span class="classifier">int, optional</span></dt><dd><p>Base seed for random number generator.</p>
</dd>
<dt><strong>legacy_secondary_seed</strong><span class="classifier">int, optional</span></dt><dd><p>Secondary seed for global numpy rng (Deprecated: Legacy reasons only).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>time_explosion</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Time elapsed since explosion.</p>
</dd>
<dt><strong>beta</strong><span class="classifier">float</span></dt><dd><p>Velocity of the inner boundary as a fraction of speed of light.</p>
</dd>
</dl>
</dd>
</dl>
<p>Initialize BlackBodySimpleSourceRelativistic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time_explosion</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>Time elapsed since explosion. Default is None.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">Any</span></dt><dd><p>Additional keyword arguments passed to parent class.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.create_packet_energies">
<span class="sig-name descname"><span class="pre">create_packet_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="(in Astropy v7.1)"><span class="pre">Quantity</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_relativistic.html#BlackBodySimpleSourceRelativistic.create_packet_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.create_packet_energies" title="Link to this definition">¶</a></dt>
<dd><p>Create relativistic packet energies with uniform distribution.</p>
<p>Uniformly distribute energy in arbitrary units where the ensemble of
packets has total energy corrected for relativistic effects. Applies
corrections for the static inner boundary to comoving frame transformation
and time dilation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd><p>Array of packet energies in erg with relativistic corrections.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.create_packet_mus">
<span class="sig-name descname"><span class="pre">create_packet_mus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_relativistic.html#BlackBodySimpleSourceRelativistic.create_packet_mus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.create_packet_mus" title="Link to this definition">¶</a></dt>
<dd><p>Create relativistic packet direction cosines.</p>
<p>Direction cosines are distributed according to the relativistic transformation
<span class="math notranslate nohighlight">\(\mu^\prime=2 \frac{\mu^\prime + \beta}{2 \beta + 1}\)</span>.
The distribution accounts for the fact that the inner boundary
on which the packets are initialized is not comoving with the material.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>numpy.ndarray</dt><dd><p>Array of relativistically corrected direction cosines for packets.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.create_packets">
<span class="sig-name descname"><span class="pre">create_packets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="tardis.transport.montecarlo.packets.packet_collections.html#tardis.transport.montecarlo.packets.packet_collections.PacketCollection" title="tardis.transport.montecarlo.packets.packet_collections.PacketCollection"><span class="pre">PacketCollection</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_relativistic.html#BlackBodySimpleSourceRelativistic.create_packets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.create_packets" title="Link to this definition">¶</a></dt>
<dd><p>Generate relativistic black-body packet properties as arrays.</p>
<p>Calculates the velocity (beta) of the inner boundary and applies
relativistic corrections to packet creation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>*args</strong><span class="classifier">Any</span></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">Any</span></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>PacketCollection</dt><dd><p>Collection of packets with relativistic corrections applied.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>If radius or time_explosion is not set.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.from_simulation_state">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_simulation_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation_state</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body_relativistic.html#tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic" title="tardis.transport.montecarlo.packet_source.black_body_relativistic.BlackBodySimpleSourceRelativistic"><span class="pre">BlackBodySimpleSourceRelativistic</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_relativistic.html#BlackBodySimpleSourceRelativistic.from_simulation_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.from_simulation_state" title="Link to this definition">¶</a></dt>
<dd><p>Create BlackBodySimpleSourceRelativistic from simulation state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>simulation_state</strong><span class="classifier">SimulationState</span></dt><dd><p>The simulation state object containing explosion time, inner radius, and temperature.</p>
</dd>
<dt><strong>*args</strong><span class="classifier">Any</span></dt><dd><p>Additional positional arguments.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">Any</span></dt><dd><p>Additional keyword arguments.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>BlackBodySimpleSourceRelativistic</dt><dd><p>New instance initialized with simulation state parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.hdf_properties">
<span class="sig-name descname"><span class="pre">hdf_properties</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['time_explosion',</span> <span class="pre">'radius',</span> <span class="pre">'temperature',</span> <span class="pre">'base_seed']</span></em><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodySimpleSourceRelativistic.hdf_properties" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tardis.transport.montecarlo.packet_source.</span></span><span class="sig-name descname"><span class="pre">BlackBodyWeightedSource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_weighted.html#BlackBodyWeightedSource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tardis.transport.montecarlo.packet_source.black_body.html#tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource" title="tardis.transport.montecarlo.packet_source.black_body.BlackBodySimpleSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlackBodySimpleSource</span></code></a></p>
<p>Weighted blackbody packet source for Monte Carlo simulations.</p>
<p>This class generates blackbody packets with energies weighted according
to their contribution to the Planck distribution, rather than uniform
energy distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>radius</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>Initial packet radius. Default is None.</p>
</dd>
<dt><strong>temperature</strong><span class="classifier">astropy.units.Quantity, optional</span></dt><dd><p>Absolute temperature. Default is None.</p>
</dd>
<dt><strong>base_seed</strong><span class="classifier">int, optional</span></dt><dd><p>Base seed for random number generator. Default is None.</p>
</dd>
<dt><strong>legacy_secondary_seed</strong><span class="classifier">int, optional</span></dt><dd><p>Secondary seed for global numpy rng (Deprecated: Legacy reasons only).
Default is None.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">Any</span></dt><dd><p>Additional keyword arguments passed to parent class.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>nus</strong><span class="classifier">astropy.units.Quantity</span></dt><dd><p>Cached packet frequencies for energy weighting.</p>
</dd>
</dl>
</dd>
</dl>
<p>Initialize BlackBodyWeightedSource.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments passed to parent class.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.create_packet_energies">
<span class="sig-name descname"><span class="pre">create_packet_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_weighted.html#BlackBodyWeightedSource.create_packet_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.create_packet_energies" title="Link to this definition">¶</a></dt>
<dd><p>Create packet energies weighted by Planck distribution.</p>
<p>Set energy weight for each packet from the relative contribution to
the Planck distribution, rather than uniform distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd><p>Array of weighted packet energies in erg.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.create_packet_nus">
<span class="sig-name descname"><span class="pre">create_packet_nus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/black_body_weighted.html#BlackBodyWeightedSource.create_packet_nus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.create_packet_nus" title="Link to this definition">¶</a></dt>
<dd><p>Create packet frequencies distributed uniformly over blackbody bounds.</p>
<p>Creates frequencies uniformly distributed over the range of frequencies
that would be generated by the base BlackBodySimpleSource distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create.</p>
</dd>
<dt><strong>l_samples</strong><span class="classifier">int, optional</span></dt><dd><p>Number of l_samples needed for sampling from BlackBodySimpleSource.
Default is 1000.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>astropy.units.Quantity</dt><dd><p>Array of packet frequencies.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.hdf_name">
<span class="sig-name descname"><span class="pre">hdf_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'black_body_weighted_source'</span></em><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.hdf_name" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.hdf_properties">
<span class="sig-name descname"><span class="pre">hdf_properties</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['radius',</span> <span class="pre">'temperature',</span> <span class="pre">'base_seed']</span></em><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.BlackBodyWeightedSource.hdf_properties" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tardis.transport.montecarlo.packet_source.</span></span><span class="sig-name descname"><span class="pre">GammaRayPacketSource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cumulative_decays_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotope_decay_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positronium_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_velocities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_velocities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">effective_times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="tardis.transport.montecarlo.packet_source.base.html#tardis.transport.montecarlo.packet_source.base.BasePacketSource" title="tardis.transport.montecarlo.packet_source.base.BasePacketSource"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePacketSource</span></code></a></p>
<p>Initialize gamma ray packet source.</p>
<p>Initializes a gamma ray packet source for creating gamma ray packets
from radioactive decay data, including support for positronium formation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cumulative_decays_df</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame containing cumulative decay data with columns including
radiation type, decay energies, and multi-level indices for
isotope, shell_number, and time_index.</p>
</dd>
<dt><strong>isotope_decay_df</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame containing isotope decay data with decay constants
and other isotope-specific parameters.</p>
</dd>
<dt><strong>positronium_fraction</strong><span class="classifier">float</span></dt><dd><p>Fraction of positrons that form positronium (0.0 to 1.0).
Used for modeling three-photon decay vs two-photon annihilation.</p>
</dd>
<dt><strong>inner_velocities</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of inner shell velocities [cm/s] for each spatial shell.</p>
</dd>
<dt><strong>outer_velocities</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of outer shell velocities [cm/s] for each spatial shell.</p>
</dd>
<dt><strong>times</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of time steps [s] used in the simulation.</p>
</dd>
<dt><strong>effective_times</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of effective time steps [s] accounting for simulation specifics.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional keyword arguments passed to the parent BasePacketSource class.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This packet source generates gamma ray packets from radioactive decay
events, with proper handling of:
- Spatial distribution within shells
- Time-dependent decay processes
- Positronium formation and decay modes
- Doppler effects from moving material</p>
<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_directions">
<span class="sig-name descname"><span class="pre">create_packet_directions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packet_directions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_directions" title="Link to this definition">¶</a></dt>
<dd><p>Create random isotropic directions for packets.</p>
<p>Generates an array of random unit vectors representing isotropic
directions for gamma ray packets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to generate directions for.</p>
</dd>
<dt><strong>seed</strong><span class="classifier">int or None</span></dt><dd><p>Random seed for reproducible direction generation.
If None, uses current random state.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of shape (3, no_of_packets) containing unit direction vectors.
Each column represents a 3D unit vector [x, y, z].</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Directions are sampled uniformly on the unit sphere to ensure
isotropic distribution in 3D space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_energies">
<span class="sig-name descname"><span class="pre">create_packet_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packet_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_energies" title="Link to this definition">¶</a></dt>
<dd><p>Create uniform packet energies for gamma ray packets.</p>
<p>Generates an array of identical packet energies for a specified
number of packets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to create energies for.</p>
</dd>
<dt><strong>energy</strong><span class="classifier">float</span></dt><dd><p>Energy value [erg] to assign to each packet.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of packet energies [erg] with length no_of_packets,
where each element equals the input energy value.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method creates uniform energy packets, where each packet
carries the same energy regardless of the specific gamma ray
line that created it. The total energy is conserved through
the packet weighting system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_mus">
<span class="sig-name descname"><span class="pre">create_packet_mus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packet_mus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_mus" title="Link to this definition">¶</a></dt>
<dd><p>Create packet directional cosines.</p>
<p>Creates packet directional cosines by calling the parent class method.
This method is inherited from BasePacketSource.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets for which to create directional cosines.</p>
</dd>
<dt><strong>*args</strong></dt><dd><p>Variable length argument list passed to parent method.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Arbitrary keyword arguments passed to parent method.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>The return value from the parent class create_packet_mus method.</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_nus">
<span class="sig-name descname"><span class="pre">create_packet_nus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positronium_fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packet_nus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_nus" title="Link to this definition">¶</a></dt>
<dd><p>Create packet frequency-energies accounting for positronium formation.</p>
<p>Generates an array of packet frequency-energies (E = h * nu) considering
positronium formation and its decay modes for positron annihilation lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>packets</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame containing packet information with ‘radiation_energy_keV’ column.</p>
</dd>
<dt><strong>positronium_fraction</strong><span class="classifier">float</span></dt><dd><p>Fraction of positrons that form positronium (0.0 to 1.0).
Default is 0.0 for no positronium formation.</p>
</dd>
<dt><strong>number_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to generate frequency-energies for.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of sampled frequency-energies [keV] with length number_of_packets.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For positron annihilation lines (511 keV), this method:
- Determines if positronium forms based on positronium_fraction
- For ortho-positronium: samples from 3-photon decay spectrum
- For para-positronium: uses the 511 keV line energy
- For direct annihilation: uses the original 511 keV energy</p>
<p>The para/ortho ratio is set by PARA_TO_ORTHO_RATIO constant (0.25).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_times_uniform_energy">
<span class="sig-name descname"><span class="pre">create_packet_times_uniform_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotopes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packet_times_uniform_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_times_uniform_energy" title="Link to this definition">¶</a></dt>
<dd><p>Sample decay times from isotope mean lifetimes using rejection sampling.</p>
<p>Generates decay times by sampling from exponential distributions
based on isotope mean lifetimes, constrained to specific time intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array indices for the packets (used for iteration).</p>
</dd>
<dt><strong>isotopes</strong><span class="classifier">pd.Series</span></dt><dd><p>Series containing parent isotope names for each packet.</p>
</dd>
<dt><strong>decay_time</strong><span class="classifier">np.ndarray</span></dt><dd><p>Array of time step indices indicating the time interval
for each packet’s decay.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of decay times [s] sampled from exponential distributions
constrained to the appropriate time intervals.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method uses rejection sampling to ensure decay times fall
within the correct time bins. For each packet:
1. Determines the time interval [t_min, t_max] from decay_time index
2. Samples from exponential distribution: t = -tau * ln(random)
3. Rejects and resamples if t is outside the interval</p>
<p>Requires self.taus attribute containing isotope mean lifetimes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_times_uniform_time">
<span class="sig-name descname"><span class="pre">create_packet_times_uniform_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">no_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packet_times_uniform_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_times_uniform_time" title="Link to this definition">¶</a></dt>
<dd><p>Sample packet decay times uniformly within a time interval.</p>
<p>Generates decay times uniformly distributed between start and end times.
This approach requires non-uniform packet energies to maintain
energy conservation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>no_of_packets</strong><span class="classifier">int</span></dt><dd><p>Number of packets to generate decay times for.</p>
</dd>
<dt><strong>start</strong><span class="classifier">float</span></dt><dd><p>Start time [s] of the sampling interval.</p>
</dd>
<dt><strong>end</strong><span class="classifier">float</span></dt><dd><p>End time [s] of the sampling interval.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of decay times [s] with length no_of_packets,
uniformly distributed between start and end.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method samples decay times uniformly in time, which means
the packet energies must be weighted according to the decay
rate at each time to properly represent the physical decay process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_velocities">
<span class="sig-name descname"><span class="pre">create_packet_velocities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampled_packets_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packet_velocities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packet_velocities" title="Link to this definition">¶</a></dt>
<dd><p>Initialize random radial velocities for packets within shells.</p>
<p>Generates random initial velocities for packets distributed within
spherical shells using a uniform distribution in volume.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sampled_packets_df</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame where each row represents a packet, containing
‘inner_velocity’ and ‘outer_velocity’ columns for shell boundaries.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>np.ndarray</dt><dd><p>Array of initial velocities [cm/s] with length equal to the number
of packets in sampled_packets_df.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses the cube root method to ensure uniform distribution in volume:
r^3 = z * r_inner^3 + (1-z) * r_outer^3, where z is uniform random [0,1].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packets">
<span class="sig-name descname"><span class="pre">create_packets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cumulative_decays_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_packets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">legacy_energy_per_packet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="tardis.energy_input.transport.GXPacket.html#tardis.energy_input.transport.GXPacket.GXPacketCollection" title="tardis.energy_input.transport.GXPacket.GXPacketCollection"><span class="pre">GXPacketCollection</span></a></span></span><a class="reference internal" href="../_modules/tardis/transport/montecarlo/packet_source/high_energy.html#GammaRayPacketSource.create_packets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tardis.transport.montecarlo.packet_source.GammaRayPacketSource.create_packets" title="Link to this definition">¶</a></dt>
<dd><p>Initialize a collection of gamma ray packets for simulation.</p>
<p>Creates a collection of gamma ray packets from radioactive decay data,
including proper spatial distribution, directional sampling, energy
assignment, and Doppler corrections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cumulative_decays_df</strong><span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame containing cumulative decay data with columns including
‘radiation’, ‘decay_energy_erg’, and multi-level index with
‘isotope’, ‘shell_number’, and ‘time_index’.</p>
</dd>
<dt><strong>number_of_packets</strong><span class="classifier">int</span></dt><dd><p>Total number of gamma ray packets to create for the simulation.</p>
</dd>
<dt><strong>legacy_energy_per_packet</strong><span class="classifier">float, optional</span></dt><dd><p>Legacy energy per packet [erg] for backwards compatibility.
If None, energy per packet is calculated from total gamma ray
energy divided by number of packets. Default is None.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>GXPacketCollection</dt><dd><p>Collection of gamma ray packets with initialized properties:
- locations: 3D positions in the simulation domain
- directions: isotropic unit direction vectors
- energies: rest frame and comoving frame energies
- frequencies: rest frame and comoving frame frequencies
- metadata: shell numbers, decay times, source isotopes</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The packet creation process includes:</p>
<ol class="arabic simple">
<li><p><strong>Energy calculation</strong>: Total gamma ray energy is divided equally
among packets (uniform energy approach)</p></li>
<li><p><strong>Spatial sampling</strong>: Packets are distributed within shells based
on decay energy weighting</p></li>
<li><p><strong>Temporal placement</strong>: Packets are positioned at decay times with
appropriate radial expansion</p></li>
<li><p><strong>Spectral sampling</strong>: Frequencies include positronium formation
effects for 511 keV annihilation lines</p></li>
<li><p><strong>Doppler corrections</strong>: Applied for relativistic motion between
rest and comoving frames</p></li>
</ol>
<p>The method ensures energy conservation while providing proper
statistical sampling of the decay process.</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tardis.transport.montecarlo.estimators.util.html" class="btn btn-neutral float-left" title="tardis.transport.montecarlo.estimators.util module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tardis.transport.montecarlo.packet_source.base.html" class="btn btn-neutral float-right" title="tardis.transport.montecarlo.packet_source.base module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 28 Aug 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>